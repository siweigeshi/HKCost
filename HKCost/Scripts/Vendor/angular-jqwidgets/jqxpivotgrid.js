/*
jQWidgets v5.1.0 (2017-Aug)
Copyright (c) 2011-2017 jQWidgets.
License: http://jqwidgets.com/license/
*/
!function(t){t.jqx.jqxWidget("jqxPivotGrid","",{}),t.extend(t.jqx._jqxPivotGrid.prototype,{defineInstance:function(){var e={scrollBarsEnabled:!0,source:null,groupingColumns:[],isGroupingEnabled:!1,_offsetX:0,_offsetY:0,_currentPosition:{},_selectStartPosition:{},_isMouseLeftButtonDown:!1,_timeLastUp:new Date,_timeLastDown:new Date,resizeTooltipEnabled:!1,isHorizontalResize:!0,_colResizeState:"NO_RESIZE",activeEditor:{Editor:null},_id:0,_colItemRangeSelectionBeg:null,_colItemRangeSelectionEnd:null,_rowItemRangeSelectionBeg:null,_rowItemRangeSelectionEnd:null,_isCTRLPressed:!1,_internalSelectMode:"CELLS_SELECT",_mostRightItemBounds:{x:0,y:0,width:0,height:0},_mostLeftItemBounds:{x:0,y:0,width:0,height:0},_adjSelectedItemsSave:{},multipleSelectionEnabled:!0,selectionEnabled:!0,selectionMode:"CELLS_SELECT",treeStyleRows:!0,autoResize:!1,cellsRenderer:null,itemsRenderer:null,localization:null};t.extend(!0,this,e),this._createPivotAreas()},_createPivotAreas:function(){this._pivotRows&&(this._pivotRows.clear(),delete this._pivotRows),this._pivotColumns&&(this._pivotColumns.clear(),delete this._pivotColumns),this._pivotCells&&(this._pivotCells._resetCanvas(),this._pivotCells.clear(),delete this._pivotCells),this._pivotRows=new t.jqx.jqxPivotGrid.pivotRows(this),this._pivotColumns=new t.jqx.jqxPivotGrid.pivotColumns(this),this._pivotCells=new t.jqx.jqxPivotGrid.pivotCells,this._pivotCells.parentPivotGrid=this},_instanceId:0,createInstance:function(e){this.element;var i=this.host,s=this;s.localizeStrings(s.localization);var n="jqx-pivotgrid jqx-rc-all jqx-widget "+this.toThemeProperty("jqx-widget-content"),o="";this._isTouchDevice()&&(o="class='jqx-grid-menu-item-touch'"),i.append("<div class='"+n+"' style='width:100%; height: 100%; overflow:hidden; position:relative; onselectstart='return false;' oncontextmenu='return false;''><div id='divContent' style='width:100px; height:100%;'></div><div id='divHScroll' style='width:100%; height:17px;'></div><div id='divVScroll' style='width:17px; height:100%;'></div><div id='divContextMenu'><ul><li "+o+"><div id='sortasc' class='jqx-pivotgrid-sortasc-icon'></div><span>"+s._localizedStrings.sortascendingstring+"</span></li><li "+o+"><div id='sortdesc' class='jqx-pivotgrid-sortdesc-icon'></div><span>"+s._localizedStrings.sortdescendingstring+"</span></li><li "+o+"><div id='sortremove' class='jqx-pivotgrid-sortremove-icon'></div><span>"+s._localizedStrings.sortremovestring+"</span></li></ul></div></div>");var r=i.find("#divContent"),l=(r[0],document.createElement("div"));l.style.position="relative",l.style.left="0px",l.style.top="0px",l.style.width="100%",l.style.height="100%",l.style.overflow="hidden",r.append(l),this.contentCanvas=this.Canvas=l,this.hostVScroll=i.find("#divVScroll"),this.hostHScroll=i.find("#divHScroll"),this.hScroll=i.find("#divHScroll").jqxScrollBar({vertical:!1,theme:this.theme}),this.vScroll=i.find("#divVScroll").jqxScrollBar({vertical:!0,theme:this.theme}),s._createContextMenu(),s.id=s._instanceId++,s._resizeLineId="divResizeLine"+s.id,t(document.body).append("<div id='"+s._resizeLineId+"' style='position: absolute; display: none;'></div>");try{s.dataBind()}catch(t){throw"Databinding exception: "+t.toString()}s._installEventHandlers(),t.jqx.utilities.resize(s.host,function(){s.refresh()},!1),s._isInitialized||(s._isInitialized=!0)},destroy:function(){this._isInitialized=!1,this.host.find("#divHScroll").off(),this.host.find("#divVScroll").off(),this._contextMenu.off(),this.removeHandler(this.host),t.jqx.utilities.resize(this.host,null,!0)},_installEventHandlers:function(){var e=this;e.hostVScroll.on("valueChanged",function(t){t.currentTarget==e.hostVScroll[0]&&e.onVScroll(t.currentValue)}),e.hostHScroll.on("valueChanged",function(t){t.currentTarget==e.hostHScroll[0]&&e.onHScroll(t.currentValue)}),e.addHandler(e.host,"mousewheel DOMMouseScroll",function(i){if(!(e._isContextMenuOpen||e._pivotDesigner&&e._pivotDesigner._isWindowOpen())){var s=t.jqx.position(i);e.isPtInRect({x:s.left,y:s.top},e._rect)&&(i.preventDefault(),e._scrollBarPositions.vertical.visible&&e.onMouseWheel(i))}}),e.addHandler(e.host,"mouseenter",function(t){t.currentTarget==e.element&&e._onMouseEnter(t)}),e.addHandler(e.host,"mouseleave",function(t){t.currentTarget==e.element&&e._onMouseLeave(t)}),e.addHandler(e.host,"mousedown",function(t){e._isContextMenuOpen||e._pivotDesigner&&e._pivotDesigner._isWindowOpen()||(t.preventDefault(),e._onMouseDown(t),this.focus())}),e.addHandler(t(document),"mouseup",function(i){if(!e._isContextMenuOpen&&!(e._pivotDesigner&&e._pivotDesigner._isWindowOpen()||(i.preventDefault(),e._onMouseUp(i),i.cancel))){var s=t.jqx.position(i);(e.isPtInRect({x:s.left,y:s.top},e._rect)||"RESIZING"==e._colResizeState)&&e._onMouseClick(i)}}),e.addHandler(t(document),"mousemove",function(t){e._isContextMenuOpen||e._pivotDesigner&&e._pivotDesigner._isWindowOpen()||e._onMouseMove(t)}),e.addHandler(t(document),"keydown",function(t){e._isContextMenuOpen||e._pivotDesigner&&e._pivotDesigner._isWindowOpen()||e._isContextMenuOpen||(17==t.keyCode?e._isCTRLPressed=!0:16==t.keyCode?e._isSHIFTPressed=!0:e._handleKeyboardNavigation&&e._handleKeyboardNavigation(t))}),e.addHandler(t(document),"keyup",function(t){e._isContextMenuOpen||e._pivotDesigner&&e._pivotDesigner._isWindowOpen()||e._isContextMenuOpen||(17==t.keyCode?e._isCTRLPressed=!1:16==t.keyCode&&(e._isSHIFTPressed=!1))})},_createContextMenu:function(){var e=this,i=this.host.find("#divContextMenu");e._contextMenu=i.jqxMenu({width:"120px",autoCloseOnClick:!0,autoOpenPopup:!1,animationShowDuration:0,animationHideDuration:0,animationShowDelay:0,theme:this.theme,keyboardNavigation:!1,mode:"popup"});for(var s=i.find("li"),n="",o=0;o<s.length;o++){var r=t(s[o]).text();r.length>n.length&&(n=r)}var l=t('<span style="white-space:nowrap;">'+n+"</span>");l.addClass(this.toThemeProperty("jqx-menu-item")),this.host.append(l);var h=l.outerWidth()+30;l.remove(),e._contextMenu=i.jqxMenu({width:h}),e._contextMenu.on("shown",function(){e._isContextMenuOpen=!0}),e._contextMenu.on("closed",function(){e._isContextMenuOpen=!1,e._hideItemMenuElement()}),e._contextMenu.on("itemclick",function(t){t.stopImmediatePropagation(),t.stopPropagation();var i=e._menuElement._itemMouseOver;if(i){var s=i.hierarchy==e._pivotColumns?e._pivotRows:e._pivotColumns,n=t.args.innerHTML;-1!=n.indexOf("sortasc")?s.sortBy(i,"asc"):-1!=n.indexOf("sortdesc")?s.sortBy(i,"desc"):-1!=n.indexOf("sortremove")&&s.removeSort()}})},_isTouchDevice:function(){if(void 0!=this.touchDevice)return this.touchDevice;var e=t.jqx.mobile.isTouchDevice();if(this.touchDevice=e,1==this.touchmode){if(t.jqx.browser.msie&&t.jqx.browser.version<9)return this.enablehover=!1,!1;e=!0,t.jqx.mobile.setMobileSimulator(this.element),this.touchDevice=e}else 0==this.touchmode&&(e=!1);return e&&0!=this.touchModeStyle&&(this.touchDevice=!0,this.host.addClass(this.toThemeProperty("jqx-touch")),this.host.find("jqx-widget-content").addClass(this.toThemeProperty("jqx-touch")),this.host.find("jqx-widget-header").addClass(this.toThemeProperty("jqx-touch")),this.scrollbarsize=this.touchscrollbarsize),e},propertyChangedHandler:function(t,e,i,s){void 0!=this._isInitialized&&0!=this._isInitialized&&("source"==e?this.dataBind():"theme"==e&&(this.hostVScrollBar.jqxScrollBar("theme",this.theme),this.hostHScrollBar.jqxScrollBar("theme",this.theme)),this._internalRefresh())},genId:function(){return this._id++},getCellId:function(t,e){return t.id+"_"+e.id},_scrollTimer:void 0,_renderOnTimeout:function(t){clearTimeout(this._scrollTimer);var e=this;0==t?(this._pivotColumns._refreshRequired=this._pivotRows._refreshRequired=!0,e._internalRefresh()):this._scrollTimer=setTimeout(function(){e._render()},t)},onVScroll:function(t){if((t=Math.round(t))!=this._offsetY){this._offsetY=t,this._renderOnTimeout(0)}},onHScroll:function(t){if((t=Math.round(t))!=this._offsetX){this._offsetX=t,this._renderOnTimeout(0)}},onMouseWheel:function(t){var e=0;if(t||(t=window.event),t.wheelDelta?e=t.wheelDelta/120:t.detail&&(e=-t.detail/3),e){t.preventDefault&&t.preventDefault(),t.returnValue=!1;var i=this.vScroll.jqxScrollBar("min"),s=this.vScroll.jqxScrollBar("max"),n=this.vScroll.jqxScrollBar("value");(n-=e*=10)>s&&(n=s),n<i&&(n=i),this.vScroll.jqxScrollBar("value",n)}},_onMouseMove:function(e){var i=t.jqx.position(e),s=i.left,n=i.top;if(this.isPtInRect({x:s,y:n},this._rect)||"RESIZING"==this._colResizeState){var o=this.host.position();if(s-=Math.round(o.left),n-=Math.round(o.top),s=Math.max(s,0),n=Math.max(n,0),this._currentPosition.x!=s||this._currentPosition.y!=n){this._currentPosition.x=s,this._currentPosition.y=n;for(var r in this._scrollBarPositions)if(this._scrollBarPositions[r].visible&&this.isPtInRect({x:s,y:n},this._scrollBarPositions[r].rect))return;this._handleMouseMove(e),this.activeEditor&&this.activeEditor.Editor}}},_onMouseEnter:function(t){},_onMouseLeave:function(t){this._hideItemMenuElement()},_onMouseDown:function(t){var e={isOnItemButton:!1},i=this._itemHitTest(this._currentPosition,e);null!=i&&this._raisePivotItemMouseEvent(i,"pivotitemmousedown",0==t.button?"left":"right")?t.cancel=!0:0==t.button?this.onMouseLeftButtonDown(t):2==t.button&&this.onMouseRightButtonDown(t)},_onMouseUp:function(t){var e={isOnItemButton:!1},i=this._itemHitTest(this._currentPosition,e);null!=i&&this._raisePivotItemMouseEvent(i,"pivotitemmouseup",0==t.button?"left":"right")?t.cancel=!0:0==t.button?this.onMouseLeftButtonUp(t):2==t.button&&this.onMouseRightButtonUp(t)},_onMouseClick:function(t){var e=this;if(e._handleMouseClick(t),!t.cancel)return e._dtLastMouseClick&&new Date-e._dtLastMouseClick<500?(this._handleMouseDoubleClick(t),void(e._dtLastMouseClick=void 0)):void(e._dtLastMouseClick=new Date)},setDivContent:function(t,e,i,s,n){var o=this.getChild(t,"innerDiv");o.style.padding=i.top+"px "+i.right+"px "+i.bottom+"px "+i.left+"px",s&&(o.style["text-align"]=s),this.setElementSize(t,parseFloat(t.style.width),parseFloat(t.style.height)),n&&(o.style.width=parseFloat(t.style.width)-i.left+"px"),o.innerHTML=e},setElementPosition:function(t,e,i){t.style.position="absolute",t.style.left=e+"px",t.style.top=i+"px"},_getFloat:function(t){for(var e,i=0;i<t.length;i++)if(e=parseFloat(t[i]),!isNaN(e))return e;return NaN},setElementSize:function(t,e,i){t.style.width=e+"px",t.style.height=i+"px";var s=this.getChild(t,"innerDiv");if(s){var n=this._getFloat([s.style.padding.left,s.style.padding,0]),o=this._getFloat([s.style.padding.right,s.style.padding,0]),r=this._getFloat([s.style.padding.top,s.style.padding,0]),l=this._getFloat([s.style.padding.bottom,s.style.padding,0]);s.style.width=e-n-o+"px",s.style.height=i-r-l+"px"}},createCanvas:function(t){var e=document.createElement("div");return e.style["background-color"]="transparent",e.style.overflow="hidden",t.appendChild(e),e},createDiv:function(t,e,i,s){var n=document.createElement("div");n.id=e,n.style.height=s+"px",n.style.width=i+"px";var o=document.createElement("div");return o.id="innerDiv",o.style.height=s+"px",o.style.width=i+"px",n.appendChild(o),t.appendChild(n),n},getPivotRows:function(){return this._pivotRows},getPivotColumns:function(){return this._pivotColumns},getPivotCells:function(){return this._pivotCells},_layout:function(){this.host.find("#divContent"),this.host.find("#divVScroll"),this.host.find("#divHScroll"),this.host.width(),this.host.height();this._pivotCells.Canvas||(this._pivotCells.Canvas=this.createCanvas(this.Canvas,"divCells",100,100)),this._pivotRows.Canvas||(this._pivotRows.Canvas=this.createCanvas(this.Canvas,"divRowsHierarchy",100,100)),this._pivotColumns.Canvas||(this._pivotColumns.Canvas=this.createCanvas(this.Canvas,"divColumnsHierarchy",100,100)),this._pivotRows.isHidden?this._pivotRows.Canvas.style.display="none":(this._pivotRows.Canvas.style.display="block",this.setElementPosition(this._pivotRows.Canvas,this._pivotRows.x,this._pivotRows.y),this.setElementSize(this._pivotRows.Canvas,this._pivotRows.getWidth()+1,this._pivotRows.getHeight()),void 0==this._pivotRows.renderCanvas&&(this._pivotRows.renderCanvas=this.createCanvas(this._pivotRows.Canvas,"divRowsRender",100,100)),this.setElementSize(this._pivotRows.renderCanvas,this._pivotRows.getWidth()+1,this._pivotRows.getHeight())),this._pivotColumns.isHidden?this._pivotColumns.Canvas.style.display="none":(this._pivotColumns.Canvas.style.display="block",this.setElementPosition(this._pivotColumns.Canvas,this._pivotColumns.x,this._pivotColumns.y),this.setElementSize(this._pivotColumns.Canvas,this._pivotColumns.getWidth(),this._pivotColumns.getHeight()+1),void 0==this._pivotColumns.renderCanvas&&(this._pivotColumns.renderCanvas=this.createCanvas(this._pivotColumns.Canvas,"divColumnsRender",100,100)),this.setElementSize(this._pivotColumns.renderCanvas,this._pivotColumns.getWidth(),this._pivotColumns.getHeight()+1)),this.setElementPosition(this._pivotCells.Canvas,this._pivotColumns.x,this._pivotRows.y),this.setElementSize(this._pivotCells.Canvas,this._pivotCells.viewPort.width,this._pivotCells.viewPort.height),void 0==this._pivotCells.renderCanvas&&(this._pivotCells.renderCanvas=this.createCanvas(this._pivotCells.Canvas,"divCellsRender",100,100)),this.setElementSize(this._pivotCells.renderCanvas,this._pivotColumns.getWidth()+1,this._pivotRows.getHeight()+1)},refresh:function(){this._pivotColumns._renderRequired=!0,this._pivotRows._renderRequired=!0,this._pivotCells.clear(),this._internalRefresh()},_internalRefresh:function(){var t=this.host.position();if(this.autoResize){var e=this._pivotColumns.isHidden?0:this._pivotColumns.getHeight(),i=this._pivotColumns.isHidden?0:this._pivotColumns.getWidth(),s=this._pivotRows.isHidden?0:this._pivotRows.getHeight(),n=this._pivotRows.isHidden?0:this._pivotRows.getWidth(),o={};o.width=i+n+1,o.height=e+s+1,o.width==this.host.width()&&o.height==this.host.height()||(this._pivotColumns._renderRequired=this._pivotRows._renderRequired=!0,this.host.css({width:o.width+"px",height:o.height+"px"}))}this._rect={x:t.left,y:t.top,width:this.host.width(),height:this.host.height()},this._render(),this.host.find("#divHScroll").jqxScrollBar("refresh")},_render:function(){var t=this._pivotColumns._renderRequired||this._pivotRows._renderRequired;this._pivotRows.compactStyleRenderingEnabled!=this.treeStyleRows&&(this._pivotRows.compactStyleRenderingEnabled=this.treeStyleRows,t=!0),t&&(this._pivotRows._renderRequired=this._pivotColumns._renderRequired=!0,this.RenderGridContent(),this._layout()),this._pivotRows.viewPort.y=this._offsetY+(this._pivotColumns.isVisible()?this._pivotColumns.viewPort.height:0),this._pivotColumns.viewPort.x=this._offsetX+(this._pivotRows.isVisible()?this._pivotRows.viewPort.width:0),this._pivotColumns.refresh(),this._pivotRows.refresh(),this._pivotCells.render(),this._updateMenuElement()},_updateMenuElement:function(){var e=this.host.find("#divContent")[0];this._menuElement&&(t(this._menuElement).off(),e.removeChild(this._menuElement));var i=document.createElement("div");i.style.height="16px",i.style.width="16px",i.style.id="menu_element",i.style.align="left",i.style.valign="top",i.style.display="none",e.appendChild(i),this._menuElement=i;var s=this;t(s._menuElement).on("click",function(){s._showItemContextMenu()})},dataBind:function(){function e(i,s,n,o,r){for(var l in i.items){h=i.items[l];(a=new t.jqx.jqxPivotGrid.pivotItem(n,o)).text=h.text,a.adapterItem=h,a.isColumn=r,s.items.push(a),e(h,a,a,o,r)}for(var l in i.valueItems){var h=i.valueItems[l],a=new t.jqx.jqxPivotGrid.pivotItem(n,o);a.adapterItem=h,a.text=h.text,a.isColumn=r,a._isValueItem=!0,s.valueItems.push(a),e(h,a,a,o,r)}}var i=this.source;this.localization&&!i.localization&&(i.localization=this.localization),i.dataBind(),this._createPivotAreas(),e(i._rowsHierarchy,this._pivotRows,null,this._pivotRows,!1),e(i._columnsHierarchy,this._pivotColumns,null,this._pivotColumns,!0),this.bindingState="DataBoundPivot",this._pivotRows.autoResize("default"),this._pivotColumns.autoResize("default"),this._internalRefresh()},getChild:function(t,e){for(var i=t.childNodes,s=0;s<i.length;s++)if(i[s].id==e)return i[s];return null},scrollToOffset:function(t,e){for(var i=this.gridcells,s=0;s<i.length;s++)i[s].style.top=e+parseInt(i[s].originalY)+"px",this.setDivContent(i[s],"cell "+s)},getWidth:function(){return this.host.width()},getHeight:function(){return this.host.height()},RenderGridContent:function(){if(!this._pivotColumns._renderRequired&&!this._pivotRows._renderRequired)return this._pivotRows.viewPort.y=this._offsetY,void(this._pivotColumns.viewPort.x=this._offsetX);if(!this.PaintSuspended&&"RESIZING"!=this._colResizeState){var t={};if(t.x=this._offsetX,t.y=this._offsetY,t.width=this.getWidth(),t.height=this.getHeight(),0!=t.width&&0!=t.height)if(this.PaintSuspended=!0,this._pivotColumns._isColumnsCountRequresUpdate&&(this._pivotColumns._updateVisibleLeaves(),this._pivotColumns._updateColumnsCount(),this._pivotColumns._updateColumnsIndexes()),this._pivotRows._isColumnsCountRequresUpdate&&(this._pivotRows._updateColumnsCount(),this._pivotRows._updateColumnsIndexes()),0!=this.getWidth()&&0!=this.getHeight()){this.GroupingEnabled&&this.groupingColumns.length>0&&(this._pivotRows.isHidden=!0),this._pivotColumns._renderRequired&&this._pivotColumns.render(),this._pivotRows._renderRequired&&this._pivotRows.render();var e=this._pivotColumns.isVisible()?this._pivotColumns.getHeight():0,i=this._pivotRows.isVisible()?this._pivotRows.getWidth():0,s={width:this._pivotColumns.getWidth()+i,height:this._pivotRows.getHeight()+e};(this.scrollableAreaSize!=s||this.isSyncScrollRequired)&&(this.scrollableAreaSize=s,this.SynchronizeScrollBars());var n=this.host.find("#divContent"),o=this.host.find("#divVScroll"),r=this.host.find("#divHScroll"),l="none"!=r.css("display"),h="none"!=o.css("display");n.css({height:t.height-(l?r.height()+4:0)+"px"}),n.css({width:t.width-(h?o.width()+4:0)+"px"});var a=t.height;t.height==this.getHeight()&&(a=t.height-e-(l?r.height()+4:0))<0&&(a=t.height),this._pivotRows.x=0,this._pivotRows.y=e,this._pivotRows.viewPort={x:this._pivotRows.x,y:t.y,width:this._pivotRows.getWidth(),height:a};var d=t.width;t.width==this.getWidth()&&(d=t.width-i-(h?o.width()+4:0))<0&&(d=t.width),this._pivotColumns.x=i,this._pivotColumns.y=0,this._pivotColumns.viewPort={x:t.x,y:this._pivotColumns.y,width:d,height:this._pivotColumns.getHeight()},this._pivotCells.Bounds={x:this._pivotColumns.x,y:this._pivotRows.y,width:this._pivotColumns.getWidth(),height:a},this._pivotCells.viewPort={x:t.x,y:t.y,width:d,height:a},null!=this.draggingItem&&dragElement.visibility==visibility.visible&&dragElement.setValue(Canvas.ZIndexProperty,1e4),this._pivotRows._renderRequired=!1,this._pivotColumns._renderRequired=!1,this.PaintSuspended=!1}else this.PaintSuspended=!1}},SynchronizeScrollBars:function(){var t=!1,e=!1,i=this.host.find("#divVScroll"),s=this.host.find("#divHScroll"),n="none"!=s.css("display"),o="none"!=i.css("display"),r=s.height();if(this.scrollableAreaSize.height>this.getHeight()&&(t=!0),this.scrollableAreaSize.width>this.getWidth()&&(e=!0),this.scrollableAreaSize.height<=this.getHeight()&&this.scrollableAreaSize.width<=this.getWidth()&&(t=!1,e=!1),t&&(e=e||this.scrollableAreaSize.width>this.getWidth()-r),e&&(t=t||this.scrollableAreaSize.height>this.getHeight()-r),t){o||!0,i[0].style.display="block";var l=this.getHeight()-(e?r+5:0);l<0&&(l=0),this.setElementPosition(i[0],this.getWidth()-r-4,0),this.setElementSize(i[0],r,l),i.jqxScrollBar("min",0);var h=this.scrollableAreaSize.height-(this.getHeight()-(e?r:0))+4;h!=i.jqxScrollBar("max")&&i.jqxScrollBar("max",h),void 0!=this.VerticalScrollBarSmallChange?i.jqxScrollBar("step",this.VerticalScrollBarSmallChange):i.jqxScrollBar("step",10);var a=this.scrollableAreaSize.height/10;a<10&&(a=10),void 0!=this.VerticalScrollBarLargeChange&&(a=verticalScrollBarLargeChange),i.jqxScrollBar("largestep")!=a&&i.jqxScrollBar("largestep",a),i.jqxScrollBar("largestep")<i.jqxScrollBar("step")&&i.jqxScrollBar("largestep",i.jqxScrollBar("step")),this.rtl}else o&&!0,i.jqxScrollBar("value",0),i[0].style.display="none";if(e){n&&!0,s[0].style.display="block";var d=this.getWidth()-(t?r+5:0);(d<0||void 0==d)&&(d=0),this.setElementPosition(s[0],0,this.getHeight()-r-4),this.setElementSize(s[0],d,r),0!=s.jqxScrollBar("min")&&s.jqxScrollBar("min",0);var u=this.scrollableAreaSize.width-(this.getWidth()-(t?r:0))+4;s.jqxScrollBar("max")!=u&&s.jqxScrollBar("max",u),void 0!=this.HorizontalScrollBarSmallChange?s.jqxScrollBar("step",this.HorizontalScrollBarSmallChange):s.jqxScrollBar("step",10);var c=this.getWidth()/2;c<25&&(c=25),void 0!=this.HorizontalScrollBarLargeChange&&(c=this.HorizontalScrollBarSmallChange),s.jqxScrollBar("largestep",c),s.jqxScrollBar("largestep")<s.jqxScrollBar("largestep")&&s.jqxScrollBar("largestep",s.jqxScrollBar("step"))}else n&&!0,s.jqxScrollBar("value",0),s[0].style.display="none";e=e&&this.scrollBarsEnabled,t=t&&this.scrollBarsEnabled,e!=("block"==s[0].display)&&(s[0].display=e?"block":"none"),t!=("block"==i[0].display)&&(i[0].display=t?"block":"none"),this._scrollBarPositions={vertical:{visible:t,rect:{x:i.position().left,y:i.position().top,width:i.width(),height:i.height()}},horizontal:{visible:e,rect:{x:s.position().left,y:s.position().top,width:s.width(),height:s.height()}}},s.jqxScrollBar("refresh"),i.jqxScrollBar("refresh")},isPtInRect:function(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},onMouseLeftButtonUp:function(e){var i=this;for(var s in i._scrollBarPositions)if(this._scrollBarPositions[s].visible&&this.isPtInRect(i._currentPosition,i._scrollBarPositions[s].rect))return;if(i._isMouseCaptured())i._releaseMouseCapture();else if(!i._itemMenuButtonMouseOver&&!i._isContextMenuOpen){i.canDrag=!1;var n=t.jqx.position(e),o=i.isPtInRect({x:n.left,y:n.top},i._rect),r=i._pivotCells._hitTest(i._currentPosition);if(!(r&&o&&i._raisePivotCellMouseEvent(r.pivotRow,r.pivotColumn,"pivotcellmouseup","left"))){if("RESIZING"==i._colResizeState){i._colResizeState="NO_RESIZE",i._updateCursor("ARROW"),i._pivotColumns._renderRequired=!0,i._pivotRows._renderRequired=!0;var l={x:i.resizingItem.x+i.resizingItem.hierarchy.x-i._offsetX,y:i.resizingItem.y+i.resizingItem.hierarchy.y-i._offsetY};return this.isHorizontalResize?i.resizingItem.setWidth(Math.max(i.resizingItem.minimumWidth,Math.abs(i._currentPosition.x-l.x))):i.resizingItem.setHeight(Math.max(i.resizingItem.minimumHeight,Math.abs(i._currentPosition.y-l.y))),t("body").find("#"+i._resizeLineId).hide(),i.resizingItem=null,i.resizeTooltipEnabled,i._isMouseLeftButtonDown=!1,void i._internalRefresh()}var h={isOnItemButton:!1},a=i._itemHitTest(i._currentPosition,h);if(null==a||!h.isOnItemButton&&!h.isOnMenuButton){var d=!1;if(i._canDrop(a)?(i._endDrag(a),d=!0):i.dragElement&&"block"==i.dragElement.style.display&&(i._endDrag(draggingItem),d=!0),d)return i._isMouseLeftButtonDown=!1,void i._internalRefresh();i._isMouseLeftButtonDown=!1,o&&null==i.activeEditor.Editor&&i._updateSelection()}}}},onMouseLeftButtonDown:function(t){for(var e in this._scrollBarPositions)if(this._scrollBarPositions[e].visible&&this.isPtInRect(this._currentPosition,this._scrollBarPositions[e].rect))return void this._captureMouse();var i={isOnItemButton:!1},s=this._itemHitTest(this._currentPosition,i);this._timeLastDown=new Date;if(this.isShiftPressed||(this._selectStartPosition={x:this._currentPosition.x,y:this._currentPosition.y}),!this._itemMenuButtonMouseOver&&!this._isContextMenuOpen){if(this._isMouseLeftButtonDown=!0,"READY_RESIZE"==this._colResizeState)return this._colResizeState="RESIZING",this._updateCursor(this.isHorizontalResize?"COLUMN_RESIZE":"ROW_RESIZE"),void this._refreshMouseCursor();if("RESIZING"!=this._colResizeState){if(null!=s){if(i.isOnItemButton){if(this._lastToggle&&this._lastToggle.item==s&&new Date-this._lastToggle.time<500)return;return this._isMouseLeftButtonDown=!1,s.isExpanded?s.collapse():s.expand(),this._lastToggle={time:new Date,item:s},void this._internalRefresh()}this.canDrag=!0,i.isOnItemButton?this._updateCursor("ARROW"):this._updateCursor("CROSS"),s.isColumn?this._internalSelectMode="COL_SELECT":this._internalSelectMode="ROW_SELECT"}else this._internalSelectMode="CELLS_SELECT";var n=this._pivotCells._hitTest(this._currentPosition);n&&this._raisePivotCellMouseEvent(n.pivotRow,n.pivotColumn,"pivotcellmousedown","left")||(null==this.activeEditor.Editor&&this._updateSelection(),this._refreshMouseCursor())}}},onMouseRightButtonDown:function(t){this._timeLastDown=new Date;var e={isOnItemButton:!1},i=this._itemHitTest(this._currentPosition,e);if(null==i){var s=this._pivotCells._hitTest(this._currentPosition);s&&this._raisePivotCellMouseEvent(s.pivotRow,s.pivotColumn,"pivotcellmousedown","right")}else this._raisePivotItemMouseEvent(i,"pivotitemmousedown","right")},onMouseRightButtonUp:function(e){var i=this,s=t.jqx.position(e),n=i.isPtInRect({x:s.left,y:s.top},i._rect),o=this._pivotCells._hitTest(this._currentPosition);o&&n&&this._raisePivotCellMouseEvent(o.pivotRow,o.pivotColumn,"pivotcellmouseup","right"),this._timeLastUp=new Date},_itemMouseMove:function(t,e){if(this.resizingItem)this.isHorizontalResize?this._updateCursor("COLUMN_RESIZE"):this._updateCursor("ROW_RESIZE");else{this._menuElement._itemMouseOver!=e&&this._hideItemMenuElement(),this._updateCursor("CROSS");var i={x:e.x,y:e.y,width:e.getDisplayWidth(),height:e.getDisplayHeight()};if(e.isColumn?i.x+=e.hierarchy.x-this._offsetX:i.y+=e.hierarchy.y-this._offsetY,e.IsRowsHierarchyItem&&_pivotRows.compactStyleRenderingEnabled&&(i.height=e.height),i.right=i.x+i.width,i.bottom=i.y+i.height,Math.abs(i.right-t.x)<=4&&t.y>=i.y&&t.y<=i.bottom){if(this.isHorizontalResize=!0,e.hierarchy.resizable&&!this._pivotColumns.isGroupingColumn(e)){if(this._updateCursor("COLUMN_RESIZE"),this.resizingItem=e.isColumn?e._getLastVisibleLeaf(e):e,!this.resizingItem.isColumn&&!this.resizingItem.isExpanded){var s=this._pivotRows._getVisibleLeafLevelItems();for(var n in s){var o=s[n];o.ItemLevel>this.resizingItem.ItemLevel&&(this.resizingItem=o)}}this._colResizeState="READY_RESIZE"}}else{if(!e.isColumn&&Math.abs(i.bottom-t.y)<=3)return this.isHorizontalResize=!1,e.IsRowsHierarchyItem&&this._pivotRows.compactStyleRenderingEnabled||(e=e._getLastVisibleLeaf(e)),void(e.hierarchy.resizable&&(this._updateCursor("ROW_RESIZE"),this.resizingItem=e,this._colResizeState="READY_RESIZE"));var r=e.hierarchy.getOtherHierarchy();e.hierarchy.sortable&&r.items.length>0&&this._hitTestShowItemMenuElement(t,e,i)}}},isInHierarchyViewPort:function(t,e){return e.isColumnsHierarchy?this.isPtInRect({x:t.x+this._offsetX,y:t.y},e.viewPort):this.isPtInRect({x:t.x,y:t.y+this._offsetY},e.viewPort)},_hitTestShowItemMenuElement:function(e,i,s){if(this._menuElement&&this._menuElement._itemMouseOver&&this._menuElement._itemMouseOver._element&&t(this._menuElement._itemMouseOver._element).find("#sortElement").show(),this._menuElement.style.display="none",!(this._isContextMenuOpen||i.valueItems.length>0)&&e.x<s.right&&e.x>s.x&&e.y>=s.y&&e.y<=s.bottom){var n=t.extend({},this._rect);n.x=n.y=0,"block"==this.vScroll[0].display&&(n.width-=this.vScroll.width()),"block"==this.hScroll[0].display&&(n.height-=this.hScroll.height());var o={x:this._currentPosition.x,y:this._currentPosition.y};if(o.x-=i.hierarchy.x-(i.hierarchy.viewPort.x-i.hierarchy.x),o.y-=i.hierarchy.y-(i.hierarchy.viewPort.y-i.hierarchy.y),menuRect={x:i.x+s.width-18,y:i.y+(s.height-16)/2+1,width:16,height:16},this._menuElement.style.height=menuRect.height+"px",this._menuElement.className=this.toThemeProperty("jqx-pivotgrid-menu-button"),i.isColumn?menuRect.x+=i.hierarchy.x-this._offsetX:menuRect.y+=i.hierarchy.y-this._offsetY,this.setElementPosition(this._menuElement,menuRect.x,menuRect.y),this.isPtInRect({x:menuRect.x,y:menuRect.y},n)&&this.isPtInRect({x:menuRect.x,y:menuRect.y+menuRect.height},n)&&this.isPtInRect({x:menuRect.x+menuRect.width,y:menuRect.y},n)&&this.isPtInRect({x:menuRect.x+menuRect.width,y:menuRect.y+menuRect.height},n)){if(this._menuElement.style.display="block",this._menuElement._itemMouseOver=i,t(this._menuElement._itemMouseOver._element).find("#sortElement").hide(),!i._currentCustomContent){var r=t(i._element).css("background-color");this._menuElement.style["background-color"]=r}i.isColumn?menuRect.x+=this._offsetX-i.hierarchy.x:menuRect.y+=this._offsetY-i.hierarchy.y,this.isPtInRect({x:o.x,y:o.y},menuRect)&&(this._itemMenuButtonMouseOver=!0)}}},_hideItemMenuElement:function(){this._menuElement&&!this._isContextMenuOpen&&"block"==this._menuElement.style.display&&(this._menuElement.style.display="none",t(this._menuElement._itemMouseOver._element).find("#sortElement").show())},_hideItemContextMenu:function(){this._contextMenu.jqxMenu("close"),this._hideItemMenuElement()},_showItemContextMenu:function(){var t=this._menuElement._itemMouseOver;if(t){var e=this._contextMenu.width(),i=this._contextMenu.height();this._contextMenu.find("#sortasc")[0].className="jqx-pivotgrid-sortasc-icon "+this.toThemeProperty("jqx-pivotgrid-sortasc-icon"),this._contextMenu.find("#sortdesc")[0].className="jqx-pivotgrid-sortdesc-icon "+this.toThemeProperty("jqx-pivotgrid-sortdesc-icon"),this._contextMenu.find("#sortremove")[0].className="jqx-pivotgrid-sortremove-icon "+this.toThemeProperty("jqx-pivotgrid-sortremove-icon");var s=-e+t.displayWidth+t.x+(t.hierarchy.viewPort.x-this._offsetX)-this._offsetX;t.isColumn||(s=t.x+t.displayWidth);var n=t.y+t.getDisplayHeight();t.isColumn||(n=t.y-this._offsetY+t.hierarchy.y),s<=1&&(s=1),n<this._pivotColumns.y+this._pivotColumns.getHeight()&&(n=this._pivotColumns.y+this._pivotColumns.getHeight()),n+i>this._rect.height&&(n=this._rect.height-i),this._contextMenu.jqxMenu("open",s+this._rect.x,n+this._rect.y),this._contextMenu.focus()}},_handleMouseMove:function(t){if("RESIZING"==this._colResizeState)return this._doResize({x:this._currentPosition.x,y:this._currentPosition.y}),void this._refreshMouseCursor();this._colResizeState="NO_RESIZE",this.resizingItem=null;var e=this._currentPosition,i=null;this.isInHierarchyViewPort({x:e.x,y:e.y},this._pivotColumns)&&(i=this._pivotColumns.hitTest(e));var s=null;if(this.isInHierarchyViewPort({x:e.x,y:e.y},this._pivotRows)&&(s=this._pivotRows.hitTest(e)),this._itemMenuButtonMouseOver=!1,null!=i||null!=s){var n=null==i?s:i;this.gridCellMouseOver=null,this._itemMouseMove(e,n),this._focusedItem!=n&&(this._focusedItem=n,this._isMouseLeftButtonDown&&this._updateSelection());l={};return this.CellsHighlightOnHierarchyItemMoveEnabled&&(n.IsRowsHierarchyItem&&"CELLS_HIGHLIGHT_ROW"==this.CellsHighlightMode||n.isColumn&&"CELLS_HIGHLIGHT_COLUMN"==this.CellsHighlightMode)&&(l=n.isColumn?{x:n.x,y:0,width:n.DisplayWidth,height:this._pivotRows.getHeight()}:{x:0,y:n.y,width:this._pivotColumns.getWidth(),height:n.getDisplayHeight()},(n.isColumn&&this.isGroupingEnabled&&this.groupingColumns.length>0||n.IsRowsHierarchyItem&&this._pivotRows.isOnRowDetails(this._currentPosition,n))&&(l={x:0,y:0,width:0,height:0})),void this._refreshMouseCursor()}this._hideItemMenuElement();this.gridCellMouseOver;this.resizingItem=null,this._focusedItem=null,this._colResizeState="NO_RESIZE",this._updateCursor("ARROW");var o=null;this.gridCellMouseOver&&((o={}).pivotColumn=this.gridCellMouseOver.pivotColumn,o.pivotRow=this.gridCellMouseOver.pivotRow);var r=this._pivotCells._hitTest(e);if(this._isMouseLeftButtonDown&&r){null!=this.gridCellMouseOver&&this.gridCellMouseOver.pivotRow==s&&this.gridCellMouseOver.pivotColumn==i||(this.gridCellMouseOver={pivotRow:r.pivotRow,pivotColumn:r.pivotColumn,pivotCells:this._pivotCells});var l={x:0,y:0,width:0,height:0};"CELLS_HIGHLIGHT_COLUMN"==this.cellsHighlightMode?l={x:this.gridCellMouseOver.pivotColumn.x,y:0,width:this.gridCellMouseOver.pivotColumn.getDisplayWidth(),height:this._pivotRows.getHeight()}:"CELLS_HIGHLIGHT_ROW"==this.cellsHighlightMode?l={x:0,y:this.gridCellMouseOver.pivotRow.y,width:this._pivotColumns.getWidth(),height:this.gridCellMouseOver.pivotRow.getDisplayHeight()}:"CELLS_HIGHLIGHT_SINGLE_CELL"==this.cellsHighlightMode&&(l={x:this.gridCellMouseOver.pivotColumn.x,y:this.gridCellMouseOver.pivotRow.y,width:this._pivotColumns.getWidth(),height:this.gridCellMouseOver.pivotRow.getDisplayHeight()},this.isGroupingEnabled&&this.groupingColumns.length>0&&this.gridCellMouseOver.pivotRow.items.length>0&&(l={x:0,y:0,width:0,height:0}),this.gridCellMouseOver.pivotRow.RowDetailsVisible&&(l.height-=this.gridCellMouseOver.pivotRow.GetRowDetailsHeight())),(this._pivotColumns.isGroupingColumn(this.gridCellMouseOver.pivotColumn)||this._pivotRows.isOnRowDetails(this._currentPosition,this.gridCellMouseOver.pivotRow))&&(l={x:0,y:0,width:0,height:0})}else this.gridCellMouseOver=null;null==this.gridCellMouseOver||this.gridCellMouseOver==o&&o.pivotRow==this.gridCellMouseOver.pivotRow&&o.pivotColumn==this.gridCellMouseOver.pivotColumn||this._isMouseLeftButtonDown&&!this._itemMenuButtonMouseOver&&(this._updateSelection(),this._internalRefresh())},_handleMouseClick:function(t){var e={isOnItemButton:!1},i=this._itemHitTest(this._currentPosition,e);if(null!=i){if(o=this._raisePivotItemMouseEvent(i,"pivotitemclick",0==t.button?"left":"right"))return void(t.cancel=!0);if(this._itemMenuButtonMouseOver||this._isContextMenuOpen)return;if(this._isMouseLeftButtonDown&&!e.isOnItemButton&&"Automatic"==i.sortMode&&0==i.valueItems.length){var s=this.cursor;this.cursor="Wait",this.cursor=s}}else{var n=this._pivotCells._hitTest(this._currentPosition);if(n){var o=this._raisePivotCellMouseEvent(n.pivotRow,n.pivotColumn,"pivotcellclick",0==t.button?"left":"right");if(o)return void(t.cancel=!0)}}},_handleMouseDoubleClick:function(t){if(null!=this.activeEditor.Editor){if(0==this.hideEditor("MOUSE_DBLCLICK",null,!0))return}if(!this._itemMenuButtonMouseOver&&!this._isContextMenuOpen){var e={isOnItemButton:!1},i=this._itemHitTest(this._currentPosition,e);if(null!=i){if(e.isOnMenuButton)return;if(n=this._raisePivotItemMouseEvent(i,"pivotitemdblclick",0==t.button?"left":"right"))return;if(this._lastToggle&&this._lastToggle.item==i&&new Date-this._lastToggle.time<500)return;0==t.button&&(i.isExpanded?i.collapse():i.expand(),i.hierarchy.selectItem(i),this._internalRefresh()),this._lastToggle={time:new Date,item:i}}else{var s=this._pivotCells._hitTest(this._currentPosition);if(s){var n=this._raisePivotCellMouseEvent(s.pivotRow,s.pivotColumn,"pivotcelldblclick",0==t.button?"left":"right");if(n)return}}this._refreshMouseCursor()}},_isMouseCaptured:function(){return!0===this._captured},_releaseMouseCapture:function(){this._captured=!1},_captureMouse:function(){this._captured=!0},_updateCursor:function(t){"ARROW"==t?this.element.style.cursor="default":"CROSS"==t?this.element.style.cursor="pointer":"COLUMN_RESIZE"==t?this.element.style.cursor="col-resize":"ROW_RESIZE"==t&&(this.element.style.cursor="row-resize")},_refreshMouseCursor:function(){},_ensureEditorFocus:function(){},focus:function(){},_itemHitTest:function(t,e){e.isOnItemButton=!1;var i=null;if(!this._pivotRows.isHidden&&this.isInHierarchyViewPort(t,this._pivotRows)&&(i=this._pivotRows.hitTest(t)),null==i&&!this._pivotColumns.isHidden&&this.isInHierarchyViewPort(t,this._pivotColumns)&&(i=this._pivotColumns.hitTest(t)),null!=i){var s={x:this._currentPosition.x,y:this._currentPosition.y};if(s.x-=i.hierarchy.x-(i.hierarchy.viewPort.x-i.hierarchy.x),s.y-=i.hierarchy.y-(i.hierarchy.viewPort.y-i.hierarchy.y),0!=i.items.length&&0!=i.expandCollapseEnabled&&i.hierarchy.showExpandCollapseButtons){var n=0;!i.hierarchy.isColumnsHierarchy&&i.hierarchy.compactStyleRenderingEnabled&&(n=24*i.itemLevel),s.x>i.x+9+n&&s.x<i.x+20+n&&s.y>i.y+9&&s.y<i.y+20&&(e.isOnItemButton=!0)}var o={x:i.x,y:i.y,width:i.getDisplayWidth(),height:i.getDisplayHeight()},r={x:i.x+o.width-16,y:i.y,width:16,height:o.height};this.isPtInRect(s,r)&&i.hierarchy.sortable&&(e.isOnMenuButton=!0)}return i},_raisePivotCellMouseEvent:function(e,i,s,n){var o=new t.Event(s);return o.owner=this,o.args={pivotRow:e,pivotColumn:i,mousebutton:n,cancel:!1},this.host.trigger(o),!!o.args.cancel},_raisePivotItemMouseEvent:function(e,i,s){var n=new t.Event(i);return n.owner=this,n.args={pivotItem:e,mousebutton:s,cancel:!1},this.host.trigger(n),!!n.args.cancel},_beginDrag:function(t){},_endDrag:function(t){},_canDrop:function(t){},_doResize:function(e){if(null!=this.resizingItem&&this.resizingItem.hierarchy.resizable&&!this._pivotColumns.isGroupingColumn(this.resizingItem)){this.isHorizontalResize?this._updateCursor("COLUMN_RESIZE"):this._updateCursor("ROW_RESIZE"),this._focusedItem=this.resizingItem;var i={x:this.resizingItem.x+2*this.resizingItem.hierarchy.x-this.resizingItem.hierarchy.viewPort.x,y:this.resizingItem.y+2*this.resizingItem.hierarchy.y-this.resizingItem.hierarchy.viewPort.y},s=!1,n=(this.resizingItem.hierarchy,t("body").find("#"+this._resizeLineId));if(this.isHorizontalResize){var o=e.x-i.x;if(o<this.resizingItem.minimumWidth)return;l={x:e.x+this._rect.x,y:this._pivotRows.y+this._rect.y};n.css({"border-right":"1px dotted #555","border-bottom":"",width:"1px",height:this._pivotCells.viewPort.height,top:l.y,left:l.x,display:"block"}),o>=this.resizingItem.minimumWidth&&o<=this.resizingItem.maximumWidth&&(this.resizeTooltipEnabled&&(this._resizeTooltip.Content="width: "+o+" pixels"),s=!0)}else{var r=e.y-i.y;if(r<this.resizingItem.minimumHeight)return;var l={x:this._pivotColumns.x+this._rect.x,y:e.y+this._rect.y};n.css({"border-bottom":"1px dotted #555","border-right":"",height:"1px",width:this._pivotCells.viewPort.width,left:l.x,top:l.y,display:"block",zIndex:5e4}),r>=this.resizingItem.minimumHeight&&r<=this.resizingItem.maximumHeight&&(this.resizeTooltipEnabled&&(this._resizeTooltip.Content="height: "+r+" pixels"),s=!0)}s&&this.resizeTooltipEnabled&&(this._resizeTooltip.visibility!=visibility.visible&&(this._resizeTooltip.visibility=visibility.visible),_resizeTooltip.setValue(Canvas.LeftProperty,e.x),_resizeTooltip.setValue(Canvas.TopProperty,e.y),_resizeTooltip.setValue(Canvas.ZIndexProperty,10002))}},_internalClearSelection:function(){this._pivotColumns._internalClearSelection(),this._pivotRows._internalClearSelection(),this._pivotCells._internalClearSelection()},_beginSelectionUpdate:function(){this._isCTRLPressed&&this.multipleSelectionEnabled||(this._pivotCells._beginSelectionUpdate(),this._pivotColumns._beginSelectionUpdate(),this._pivotRows._beginSelectionUpdate())},_endSelectionUpdate:function(){this._pivotColumns._endSelectionUpdate(),this._pivotRows._endSelectionUpdate(),this._pivotCells._endSelectionUpdate()},_updateSelection:function(){if(this.selectionEnabled){this._colItemRangeSelectionBeg=null,this._rowItemRangeSelectionBeg=null,this._beginSelectionUpdate();var t=!1;if(this._isCTRLPressed&&0!=this.multipleSelectionEnabled||(this._internalClearSelection(),t=!0),null!=this.activeEditor.Editor)return this._internalClearSelection(),void this._endSelectionUpdate();var e=-1,i=-1,s={x:this._selectStartPosition.x,y:this._selectStartPosition.y};s.y-=this._offsetY,s.x-=this._offsetX;var n={isOnItemButton:!1},o=this._itemHitTest(this._selectStartPosition,n);if(null!=o)if(!o.isColumn&&this._pivotRows.compactStyleRenderingEnabled||(o=o._getFirstVisibleLeaf(o)),o.isColumn){if("FULL_ROW_SELECT"==this.selectionMode)return this._internalSelectMode="NO_SELECT",void this._endSelectionUpdate();this._internalSelectMode="COL_SELECT",this._colItemRangeSelectionBeg=o}else{if("FULL_COLUMN_SELECT"==this.selectionMode)return this._internalSelectMode="NO_SELECT",this._endSelectionUpdate(),void this._internalRefresh();this._internalSelectMode="ROW_SELECT",this._rowItemRangeSelectionBeg=o}else{if(!(a=this._pivotCells._hitTest(this._selectStartPosition)))return this._internalSelectMode="NO_SELECT",this._endSelectionUpdate(),void this._internalRefresh();this._internalSelectMode="CELLS_SELECT","FULL_ROW_SELECT"==this.selectionMode?this._internalSelectMode="ROW_SELECT":"FULL_COLUMN_SELECT"==this._SelectionMode&&(this._internalSelectMode="COL_SELECT")}var r={x:this._currentPosition.x,y:this._currentPosition.y};"COL_SELECT"==this._internalSelectMode?(r.y>=this._pivotColumns.y+this._pivotColumns.getHeight()&&(r.y=this._pivotColumns.y+this._pivotColumns.getHeight()-1),r.y<=this._pivotColumns.y&&(r.y=this._selectStartPosition.y),r.x<=this._pivotColumns.x&&(r.x=this._pivotColumns.x+1),r.x>=this._pivotColumns.x+this._pivotColumns.getWidth()&&(r.x=this._pivotColumns.x+this._pivotColumns.getWidth()-1)):"ROW_SELECT"==this._internalSelectMode?(r.y>=this._pivotRows.y+this._pivotRows.getHeight()&&(r.y=this._pivotRows.y+this._pivotRows.getHeight()-1),r.y<=this._pivotRows.y&&(r.y=this._pivotRows.y+1),r.x<=this._pivotRows.x&&(r.x=this._pivotRows.x+this._pivotRows.getWidth()-1),r.x>=this._pivotRows.x+this._pivotRows.getWidth()&&(r.x=this._pivotRows.x+this._pivotRows.getWidth()-1)):"CELLS_SELECT"==this._internalSelectMode&&(r.x<this._pivotColumns.x&&(r.x=this._pivotColumns.x+1),r.y<this._pivotRows.y&&(r.y=this._pivotRows.y+1)),this._colItemRangeSelectionEnd=null,this._rowItemRangeSelectionEnd=null;var l=-1,h=-1;if("COL_SELECT"==this._internalSelectMode||"ROW_SELECT"==this._internalSelectMode)if(null!=o){var a={},d=this._itemHitTest(r,a);if(null==d)return void this._endSelectionUpdate();!d.isColumn&&this._pivotRows.compactStyleRenderingEnabled||(d=d._getLastVisibleLeaf(d)),d.isColumn?this._colItemRangeSelectionEnd=d:this._rowItemRangeSelectionEnd=d}else this._pivotCells.hitTest(r,a),null!=a?(this._colItemRangeSelectionEnd=a.pivotColumn,this._rowItemRangeSelectionEnd=a.pivotRow):(this._colItemRangeSelectionEnd=null,this._rowItemRangeSelectionEnd=null);if("CELLS_SELECT"==this._internalSelectMode){a=this._pivotCells._hitTest(this._selectStartPosition);if(this._colItemRangeSelectionBeg=a.pivotColumn,this._rowItemRangeSelectionBeg=a.pivotRow,!a)return this._endSelectionUpdate(),void this._internalRefresh();if(s.x==r.x&&s.y==r.y||(this._pivotCells.hitTest(r,a),this._colItemRangeSelectionEnd=a.pivotColumn,this._rowItemRangeSelectionEnd=a.pivotRow),!a.pivotRow||!a.pivotColumn)return this._internalSelectMode="CELLS_SELECT",this._pivotCells._internalSelectCell(this._rowItemRangeSelectionBeg,this._colItemRangeSelectionBeg),this._cellKBRangeSelectionStart=this._cellKBRangeSelectionEnd={pivotRow:this._rowItemRangeSelectionBeg,pivotColumn:this._colItemRangeSelectionBeg,pivotCells:this._pivotCells},this._endSelectionUpdate(),void this._internalRefresh()}if(this._saveSelectedItemsRangeOrder(),this._adjustSelectedItemsOrder(t),"CELLS_SELECT"==this._internalSelectMode){var u=this._pivotRows._getVisibleLeafLevelItems(),c=this._pivotColumns._getVisibleLeafLevelItems(),i=this._pivotRows._pointToLeafItemIndexAbsolute(this._selectStartPosition),h=this._pivotRows._pointToLeafItemIndexAbsolute(r),e=this._pivotColumns._pointToLeafItemIndexAbsolute(this._selectStartPosition),l=this._pivotColumns._pointToLeafItemIndexAbsolute(r);if(-1==e&&-1==l||-1==i&&-1==h)return this._endSelectionUpdate(),void this._internalRefresh();if(-1==e&&(e=l),-1==l&&(l=e),-1==i&&(i=h),-1==h&&(h=i),l<e){v=e;e=l,l=v}if(h<i){var v=i;i=h,h=v}for(var m=i;m<=h&&m<u.length;m++)for(var p=u[m],_=e;_<=l&&_<c.length;_++){var g=c[_];this._pivotCells._internalSelectCell(p,g)}return this._cellKBRangeSelectionStart={pivotRow:this._rowItemRangeSelectionBeg,pivotColumn:this._colItemRangeSelectionBeg,pivotCells:this._pivotCells},this._cellKBRangeSelectionEnd={pivotRow:this._rowItemRangeSelectionEnd,pivotColumn:this._colItemRangeSelectionEnd,pivotCells:this._pivotCells},this._endSelectionUpdate(),void this._internalRefresh()}this._restoreSelectedItemsRangeOrder(),this._applyItemsMultiSelect(t),this._endSelectionUpdate(),this._internalRefresh()}},_saveSelectedItemsRangeOrder:function(){this._adjSelectedItemsSave.colBeg=this._colItemRangeSelectionBeg,this._adjSelectedItemsSave.colEnd=this._colItemRangeSelectionEnd,this._adjSelectedItemsSave.rowBeg=this._rowItemRangeSelectionBeg,this._adjSelectedItemsSave.rowEnd=this._rowItemRangeSelectionEnd},_restoreSelectedItemsRangeOrder:function(){this._colItemRangeSelectionBeg=this._adjSelectedItemsSave.colBeg,this._colItemRangeSelectionEnd=this._adjSelectedItemsSave.colEnd,this._rowItemRangeSelectionBeg=this._adjSelectedItemsSave.rowBeg,this._rowItemRangeSelectionEnd=this._adjSelectedItemsSave.rowEnd},_adjustSelectedItemsOrder:function(t){if(null!=this._colItemRangeSelectionBeg&&null!=this._colItemRangeSelectionEnd&&this._colItemRangeSelectionBeg.x>this._colItemRangeSelectionEnd.x){e=this._colItemRangeSelectionBeg;this._colItemRangeSelectionBeg=this._colItemRangeSelectionEnd,this._colItemRangeSelectionEnd=e}if(null!=this._rowItemRangeSelectionBeg&&null!=this._rowItemRangeSelectionEnd&&this._rowItemRangeSelectionBeg.y>this._rowItemRangeSelectionEnd.y){var e=this._rowItemRangeSelectionBeg;this._rowItemRangeSelectionBeg=this._rowItemRangeSelectionEnd,this._rowItemRangeSelectionEnd=e}(0==this.multipleSelectionEnabled&&!t||null==this._rowItemRangeSelectionEnd)&&(this._rowItemRangeSelectionEnd=this._rowItemRangeSelectionBeg),(0==this.multipleSelectionEnabled&&!t||null==this._colItemRangeSelectionEnd)&&(this._colItemRangeSelectionEnd=this._colItemRangeSelectionBeg)},_applyItemsMultiSelect:function(t){this._saveSelectedItemsRangeOrder(),this._adjustSelectedItemsOrder(t);for(var e=0;e<2;e++)if(!("COL_SELECT"==this._internalSelectMode&&0!=e||"ROW_SELECT"==this._internalSelectMode&&1!=e)){var i=0==e?this._colItemRangeSelectionBeg:this._rowItemRangeSelectionBeg,s=0==e?this._colItemRangeSelectionEnd:this._rowItemRangeSelectionEnd,n=0==e?this._pivotColumns:this._pivotRows,o=n._getVisibleLeafLevelItems();if(null==o)return this._internalRefresh(),void this._restoreSelectedItemsRangeOrder();var r=!1;for(var l in o){var h=o[l];if((h==i||r)&&(h.getWidthWithChildren()+h.x>this._mostRightItemBounds.x+this._mostRightItemBounds.width&&(this._mostRightItemBounds={x:h.x,y:h.y,width:h.getWidthWithChildren(),height:h.getHeightWithChildren()}),h.getWidthWithChildren()+h.x<this._mostLeftItemBounds.x+this._mostLeftItemBounds.width&&(this._mostLeftItemBounds={x:h.x,y:h.y,width:h.getWidthWithChildren(),height:h.getHeightWithChildren()}),r=!0,n._internalSelectItem(h),h==s))break}!n.isColumnsHierarchy&&n.compactStyleRenderingEnabled||n._applySelectionToParentItems()}this._restoreSelectedItemsRangeOrder()},localizeStrings:function(e,i){var s=this;t.jqx.dataFormat&&t.jqx.dataFormat.cleardatescache(),s._localizedStrings={decimalseparator:".",thousandsseparator:",",sortascendingstring:"Sort Ascending",sortdescendingstring:"Sort Descending",sortremovestring:"Remove Sort",alignment:"Text alignment",cellalignment:"Number alignment",numberformat:"Number format",prefix:"Number prefix",decimalplacestext:"Decimal places",thousandsseparatortext:"Thousands separator",decimalseparatortext:"Decimal separator",nagativebracketstext:"Nagatives in brackets",fieldsettings:"Field settings",ok:"Ok",cancel:"Cancel"};var n=t.extend({},e);s._localizedStrings=t.extend(s._localizedStrings,n);for(var o in n)o&&o.toLowerCase()!==o&&(n[o.toLowerCase()]=n[o]);for(var r in s._localizedStrings)void 0!==n[r]&&(s._localizedStrings[r]=n[r])}})}(jqxBaseFramework),$.jqx.jqxPivotGrid=$.jqx.jqxPivotGrid||{},$.jqx.define($.jqx.jqxPivotGrid,"propertyBag",""),$.extend($.jqx.jqxPivotGrid.propertyBag.prototype,{defineInstance:function(){this.namedPropertyTables={},this._tableSizes={},this.enablePropertyChangeNotifications=!1},getPropertyTable:function(t){return void 0==this.namedPropertyTables[t]&&(this.namedPropertyTables[t]={},this._tableSizes[t]=0),this.namedPropertyTables[t]},getPropertyCount:function(t){return null==this.getPropertyTable(t)?0:this._tableSizes[t]},getPropertyValue:function(t,e){var i=this.getPropertyTable(t);return null==i?null:void 0!=i[e]?i[e]:null},containsPropertyValue:function(t,e){var i=this.getPropertyTable(t);return null!=i&&void 0!=i[e]},removePropertyValue:function(t,e){var i=this.getPropertyTable(t);null!=i&&(delete i[e],this._tableSizes[t]--)},setPropertyValue:function(t,e,i){var s=this.getPropertyTable(t);null!=s&&(null==i||void 0==i?s[e]&&(this._tableSizes[t]--,delete s[e]):(s[e]||this._tableSizes[t]++,s[e]=i),this.enablePropertyChangeNotifications&&this.onPropertyChanged(t))},clear:function(t){if(""!=t&&null!=t&&void 0!=t){this.getPropertyTable(t);({}),this._tableSizes[t]=0}else this.namedPropertyTables={}},onPropertyChanged:function(t){$.event.trigger("propertychanged",t)}}),function(t){t.jqx.jqxPivotGrid=t.jqx.jqxPivotGrid||{},t.jqx.define(t.jqx.jqxPivotGrid,"pivotCells",""),t.extend(t.jqx.jqxPivotGrid.pivotCells.prototype,{defineInstance:function(){this.parentPivotGrid=null,this.IsDataBoundPivotCellsEditable=!1,this.cellProperties=new t.jqx.jqxPivotGrid.propertyBag,this.hashCellAutoSize={},this.hashCellInSpan={},this.hashCellSpan={},this._selectedCells=new Object},hitTest:function(t){var e=this._hitTest(t);if(e)return{pivotRow:e.pivotRow,pivotColumn:e.pivotColumn,pivotCells:this}},_hitTest:function(t){var e={};if(e.pivotColumn=this.parentPivotGrid._pivotColumns._pointToLeafItemAbsolute(t),e.pivotRow=this.parentPivotGrid._pivotRows._pointToLeafItemAbsolute(t),!this.parentPivotGrid._pivotColumns.isGroupingColumn(e.pivotColumn)&&null!=e.pivotColumn&&null!=e.pivotRow)return e},clear:function(){this._reset()},_reset:function(){this.cellProperties.clear(),this._selectedCells=new Object,this.hashCellAutoSize={},this.hashCellInSpan={},this.hashCellSpan={},this._clearElementsAndCellsCache()},_resetCanvas:function(){var e=t.jqx.get(this,"renderCanvas");if(e)for(;e.hasChildNodes();)e.removeChild(e.firstChild)},_clearElementsAndCellsCache:function(){this._clearCellsCache()},setCellValue:function(t,e,i){if(null!=t&&null!=e){var s=this.parentPivotGrid.getCellId(e,t),n=(this.getCellDataSource(t,e),-1!=t.BoundFieldIndex&&-1!=e.BoundFieldIndex);if("DataBound"==dsType&&n){if(this.parentPivotGrid.OnCellValueChanging(t,e,i))return;try{this.parentPivotGrid.setCellValueFromDataSourceNonPivot(t,e,i)}catch(t){return}return this.cellProperties.setPropertyValue("CellValue",s,null),void this.parentPivotGrid.OnCellValueChanged(t,e)}if("DataBoundPivot"==dsType){if(this.IsDataBoundPivotCellsEditable)return;throw"The cell's value is derived from the data source and aggregated. It is not editable in this mode. Use the SetCellDataSource method to change the cell's data source first"}this.parentPivotGrid.OnCellValueChanging(t,e,i)||(this.SetCellDataSource(t,e,"Static"),this.cellProperties.setPropertyValue("CellValue",s,i),this.onPropertyChanged("CellValue"),this.parentPivotGrid.OnCellValueChanged(t,e))}},_clearCellsCache:function(){this.cellProperties.clear("CellValue")},_clearCachedCell:function(t,e){var i=this.parentPivotGrid.getCellId(e,t);this.cellProperties.containsPropertyValue("CellValue",i)&&this.cellProperties.removePropertyValue("CellValue",i)},drillThroughCell:function(t,e){if(!t||t.isColumn)throw"Invalid pivotRow parameter";if(!e||!e.isColumn)throw"Invalid pivotColumn parameter";return this.parentPivotGrid.source.drillThroughPivotCell(t.adapterItem,e.adapterItem)},getCellValue:function(t,e){var i=null;if(this.parentPivotGrid._pivotColumns.isGroupingColumn(e))return null;var s=this.parentPivotGrid.getCellId(e,t),n=this.getCellDataSource(t,e);switch((t.isTotal||e.isTotal)&&(n="Virtual"),n){case"Virtual":i=this.parentPivotGrid.onCellValueNeeded(t,e),this.cellProperties.setDirty(s),null==i&&"BoundPivot"==this.parentPivotGrid.bindingState&&(t.isTotal||e.isTotal)&&(i=this.parentPivotGrid.getCellValueFromDataSource(t,e));break;case"DataBoundPivot":null==(i=this.cellProperties.getPropertyValue("CellValue",s))&&(i=this.parentPivotGrid.source.getCellValue(t.adapterItem,e.adapterItem),this.cellProperties.getPropertyCount("CellValue")<4e6&&this.cellProperties.setPropertyValue("CellValue",s,i));break;case"DataBound":if(null==(i=this.cellProperties.getPropertyValue("CellValue",s))){try{i=this.parentPivotGrid.getCellValueFromDataSourceNonPivot(t,e)}catch(t){return null}this.cellProperties.getPropertyCount("CellValue")<4e6&&this.cellProperties.setPropertyValue("CellValue",s,i)}break;case"NotSet":case"Static":default:i=this.cellProperties.getPropertyValue("CellValue",s)}return i},setCellDataSource:function(t,e,i){if(null!=t&&null!=e){var s=this.parentPivotGrid.getCellId(e,t);this.cellProperties.setPropertyValue("cellDataSource",s,i)}},getCellDataSource:function(t,e){var i=this.parentPivotGrid.getCellId(e,t),s=this.cellProperties.getPropertyValue("cellDataSource",i);return null==s&&(s=e.cellDataSource),null!=s&&"NotSet"!=s||(s=t.cellDataSource),null!=s&&"NotSet"!=s?s:this.parentPivotGrid.UseVirtualCellsByDefault?"Virtual":"DataBound"==this.parentPivotGrid.bindingState||"DataBoundPivot"==this.parentPivotGrid.bindingState?this.parentPivotGrid.bindingState:"NotSet"},render:function(){var e=this.renderCanvas;if(e){var i=this.parentPivotGrid;i.setElementPosition(e,-this.parentPivotGrid._offsetX,-this.parentPivotGrid._offsetY);var s=i._pivotRows,n=i._pivotColumns;if(this._refreshRequired||s._isVirtualMode||n._isVirtualMode){var o=s._getLeafItemsToRender(),r=n._getLeafItemsToRender();this._cellElements=this._cellElements||{};for(var l=new Array,h=new Date,a={first:s._isVirtualMode?o.first:0,last:s._isVirtualMode?o.last:o.items.length-1},d={first:n._isVirtualMode?r.first:0,last:n._isVirtualMode?r.last:r.items.length-1},u=a.last;u>=a.first;u--)for(var c=d.last;c>=d.first;c--)if(-1!=u&&-1!=c){var v=o.items[u],m=r.items[c],p=i.getCellId(m,v),_=m.getDisplayWidth()-1,g=v.getDisplayHeight()-1,C=this.isCellSelected(v,m),f=this._cellElements[p],y=void 0;f&&f.isSelected==C&&(y=f.element);var x={left:4,top:4,right:4,bottom:4},I=this.getCellValue(v,m),S="";if(y)y.style.width==_+"px"&&y.style.height==g+"px"||this.parentPivotGrid.setElementSize(y,_,g);else{(y=i.createDiv(e,S,_,g)).cellId=p,this._cellElements[p]={element:y,isSelected:C},i.setElementSize(y,_,g);var R="right";if(i.cellsRenderer&&t.isFunction(i.cellsRenderer))S=i.cellsRenderer({value:I.value,formattedValue:I.formattedValue,isSelected:C,pivotRow:v,pivotColumn:m}),x={left:0,top:0,right:0,bottom:0};else{S=void 0!==I&&void 0!==I.formattedValue?I.formattedValue.toString():"";var w=this.parentPivotGrid.source.getCellFormatSettings(v.adapterItem,m.adapterItem);w&&(R=w.align||"right")}this.parentPivotGrid.setDivContent(y,S,x,R),y.originalY=y.style.top,y.className=this.parentPivotGrid.toThemeProperty("jqx-grid-cell-normal")}y.tRender=h,"block"!=y.style.display&&(y.style.display="block"),y.style.left==m.x+"px"&&y.style.top==v.y+"px"||this.parentPivotGrid.setElementPosition(y,m.x,v.y);var P="cellsClassName";this.isCellSelected(v,m)?(y.className=this.parentPivotGrid.toThemeProperty("jqx-grid-cell-selected jqx-fill-state-hover jqx-widget-content"),P="cellsClassNameSelected"):y.className=this.parentPivotGrid.toThemeProperty("jqx-grid-cell-normal jqx-widget-content");var E=t.jqx.getByPriority([v[P],v.adapterItem&&v.adapterItem.boundField?v.adapterItem.boundField[P]:void 0,m[P],m.adapterItem&&m.adapterItem.boundField?m.adapterItem.boundField[P]:void 0]);E&&(y.className+=" "+E),y.className+=" jqx-pivotgrid-content-wrapper"}for(var b=0;b<e.childNodes.length;b++)e.childNodes[b].cellId&&e.childNodes[b].tRender!=h&&l.push(e.childNodes[b]);for(;;){if(!(y=l.pop()))break;delete this._cellElements[y.cellId],y.style.display="none",e.removeChild(y)}this._refreshRequired=!1}}},_beginSelectionUpdate:function(){for(var t in this._selectedCells)this._selectedCells[t].OldIsSelected=this._selectedCells[t].isSelected},_endSelectionUpdate:function(){var t=new Array;for(var e in this._selectedCells){var i=this._selectedCells[e];i.isSelected||t.push(e),i.isSelected,i.OldIsSelected}if(t.length>0)for(var e in t)delete this._selectedCells[t[e]]},_internalClearSelection:function(){for(var t in this._selectedCells)this._internalUnselectCell(this._selectedCells[t].pivotRow,this._selectedCells[t].pivotColumn)},clearSelection:function(){this._beginSelectionUpdate(),this._internalClearSelection(),this._endSelectionUpdate(),this.render()},selectCell:function(t,e){this.parentPivotGrid.selectionEnabled&&(this._beginSelectionUpdate(),this._internalSelectCell(t,e),this.parentPivotGrid._cellKBRangeSelectionStart={pivotRow:t,pivotColumn:e,pivotCells:this},this.parentPivotGrid._cellKBRangeSelectionEnd={pivotRow:t,pivotColumn:e,pivotCells:this},this._endSelectionUpdate())},_internalSelectCell:function(t,e){if(null==e||!this.parentPivotGrid._pivotColumns.isGroupingColumn(e)){if("NO_SELECT"==this.parentPivotGrid._internalSelectMode)switch(this.parentPivotGrid.selectionMode){case"CELL_SELECT":this.parentPivotGrid._internalSelectMode="CELLS_SELECT";break;case"FULL_COLUMN_SELECT":this.parentPivotGrid._internalSelectMode="COL_SELECT";break;case"FULL_ROW_SELECT":this.parentPivotGrid._internalSelectMode="ROW_SELECT"}var i=this.parentPivotGrid.getCellId(e,t);delete this._cellElements[i],void 0==this._selectedCells[i]?this._selectedCells[i]={pivotRow:t,pivotColumn:e,isSelected:!0}:this._selectedCells[i].isSelected=!0,this._refreshRequired=!0}},unselectCell:function(t,e){this._beginSelectionUpdate(),this._internalUnselectCell(t,e),this._endSelectionUpdate()},_internalUnselectCell:function(t,e){var i=this.parentPivotGrid.getCellId(e,t);void 0!=this._selectedCells[i]&&(this._selectedCells[i].isSelected=!1),delete this._cellElements[i],this._refreshRequired=!0},isCellSelected:function(t,e){var i=this.parentPivotGrid.getCellId(e,t);return!(!e.isSelected&&!t.isSelected)||void 0!=this._selectedCells[i]&&this._selectedCells[i].isSelected},getSelectedCellsCount:function(){return this._selectedCells.length},getSelectedCells:function(){var t=new Array;for(var e in this._selectedCells){var i=this._selectedCells[e];i.isSelected&&t.push({pivotRow:i.pivotRow,pivotColumn:i.pivotColumn,pivotCells:this})}return t},getNextCell:function(t,e){var i={};switch(e){case"left":i={x:t.pivotColumn.x-1,y:t.pivotRow.y+1};break;case"right":i={x:t.pivotColumn.x+t.pivotColumn.getWidth()+1,y:t.pivotRow.y+1};break;case"top":i={x:t.pivotColumn.x+1,y:t.pivotRow.y-1};break;case"bottom":i={x:t.pivotColumn.x+1,y:t.pivotRow.y+t.pivotRow.getHeight()+1}}var s={x:i.x+2*this.parentPivotGrid._pivotColumns.x-this.parentPivotGrid._pivotColumns.viewPort.x,y:i.y+2*this.parentPivotGrid._pivotRows.y-this.parentPivotGrid._pivotRows.viewPort.y},n=this._hitTest(s);if(n)return n}})}(jqxBaseFramework),function(t){t.jqx.jqxPivotGrid=t.jqx.jqxPivotGrid||{},t.jqx.jqxPivotGrid.pivotItem=function(t,e){this.text="Item",this.isExpanded=!1,this.expandCollapseEnabled=!0,this.isHidden=!1,this.isFiltered=!1,this.isSelected=!1,this._height=26,this._width=18,this.isDirty=!0,this.parentItem=t||null,this.hierarchy=e||t.hierarchy,this.parentPivotGrid=this.hierarchy.parentPivotGrid,this.id=this.parentPivotGrid.genId(),this.itemLevel=0,this.itemColumn=0,this._itemOrdinal=NaN,this.x=0,this.y=0,this.hierarchyItemWidth=70,this.hierarchyItemHeight=26,this.widthWithChildrenCached=0,this.minimumWidth=18,this.maximumWidth=1e7,this.minimumHeight=8,this.maximumHeight=1/0,this.items=new Array,this.valueItems=new Array},t.extend(t.jqx.jqxPivotGrid.pivotItem.prototype,{_getChildItemsToRender:function(t){for(var e=0;e<this.items.length;e++){var i=this.items[e];i.isHidden||i.isFiltered||(t.push(i),i.isExpanded&&i._getChildItemsToRender(t))}},_calculateWidthWithChildren:function(){if(this.isHidden)this.widthWithChildrenCached=0;else{var t=!this.isColumn&&this.hierarchy.compactStyleRenderingEnabled;if(t)this.widthWithChildrenCached=this.hierarchy.getColumnWidth(0);else if(this.widthWithChildrenCached=this.getWidth(),null!=this.items&&null!=this.valueItems&&(this.getVisibleItemsCount()>0||!this.isColumn&&!t)){var e=0;if(this.isColumn){if(e=0,this.isExpanded)for(s=0;s<this.items.length;s++)this.items[s].isHidden||(e+=this.items[s].getWidthWithChildren());for(s=0;s<this.valueItems.length;s++)this.valueItems[s].isHidden||(e+=this.valueItems[s].getWidthWithChildren())}else for(var i=this.hierarchy.getMaxVisibleLevelDepth(),s=this.itemLevel;s<=i;s++)e+=this.hierarchy.getColumnWidth(s);this.widthWithChildrenCached=e}else this.widthWithChildrenCached=this.getWidth()}},getWidthWithChildren:function(){return this.hierarchy._renderRequired&&this._calculateWidthWithChildren(),this.widthWithChildrenCached},getDisplayWidth:function(){if(!this.isDirty&&!this.hierarchy._renderRequired)return displayWidth;var t=this.hasVisibleValueItems();return this.isColumn?this.displayWidth=this.isExpanded||t?this.getWidthWithChildren():this.getWidth():(this.displayWidth=!this.hierarchy.isColumnsHierarchy&&this.hierarchy.compactStyleRenderingEnabled?this.getWidthWithChildren():this.getWidth(),this.isExpanded||t||(this.displayWidth=this.hierarchy.getWidth()-this.x)),this.displayWidth<18&&(this.displayWidth=18),this.displayWidth},getWidth:function(){if(this.isHidden||this.isFiltered)return 0;if(null==this.hierarchy)return 0;var t=this.itemColumn;!this.hierarchy.isColumnsHierarchy&&this.hierarchy.compactStyleRenderingEnabled&&(t=0);var e=this.minimumWidth;if(this.isColumn){if(e=this.hierarchyItemWidth,this.parentItem){var i=this.parentItem.getWidth();i>e&&this.parentItem.widthWithChildrenCached}}else e=this.hierarchy.getColumnWidth(t);return e},_measureElement:function(e){var i=t("<span style='visibility: hidden; white-space: nowrap;'>"+e+"</span>");t(document.body).append(i);var s=this.hierarchy.sortable?16:0,n={width:i.width()+s+8,height:i.height()+8};return i.remove(),n},autoResize:function(t){t||(t="fitItemContent"),this.isColumn?this.setWidth(this.minimumWidth):this.setHeight(this.minimumHeight),"default"!=t&&"fitAll"!=t&&"fitItemContent"!=t||this._autoResizeBestItemContent(t),"default"!=t&&"fitAll"!=t&&"fitItemContent"!=t||this.isColumn&&null!=this.parentItem&&this.getWidth()<this.parentItem.getWidth()&&this.setWidth(this.parentItem.getWidth())},_autoResizeBestItemContent:function(t){this._updateVisibleChildItemsCount(),sz=this._measureElement(this.text),"default"==t&&this.adapterItem.boundField&&(isNaN(this.adapterItem.boundField.width)||(sz.width=this.adapterItem.boundField.width),isNaN(this.adapterItem.boundField.height)||(sz.height=this.adapterItem.boundField.height)),this.itemColumn>=this.hierarchy._getColumnsCount()&&this.hierarchy._updateColumnsCount(),this._visibleChildItemsCount>0&&(sz.width+=30),(this.getWidth()<sz.width||"default"==t&&this.adapterItem.boundField&&!isNaN(this.adapterItem.boundField.width))&&this.setWidth(sz.width),this.isColumn?this.parentPivotGrid._pivotColumns.getHeight()<sz.height&&this.parentPivotGrid._pivotColumns.setRowHeight(this,sz.height):this.getHeight()<sz.height&&this.setHeight(sz.height);for(var e in this.items)this.items[e]._autoResizeBestItemContent(t);for(var e in this.valueItems)this.valueItems[e]._autoResizeBestItemContent(t);null!=this.hierarchy&&(this.hierarchy._renderRequired=!0)},_autoResizeBestCellFit:function(t){if(null!=this.hierarchy&&this.hierarchy._renderRequired&&this.hierarchy.render(),null!=this.hierarchy&&this.hierarchy.ColumnsCountRequresUpdate&&this.hierarchy._updateColumnsCount(),0==this.items.length&&0==this.valueItems.length){if(null!=this.hierarchy&&null!=this.parentPivotGrid&&null!=this.parentPivotGrid._pivotCells&&null!=this.parentPivotGrid._pivotRows&&null!=this.parentPivotGrid._pivotColumns){var e={width:1,height:1},i=(this.isColumn?this.parentPivotGrid._pivotRows:this.parentPivotGrid._pivotColumns,this._getVisibleLeafLevelItems());for(var s in i){i[s].isColumn||i[s],i[s].isColumn&&i[s];var n={width:10,height:10};e.width<n.width&&(e.width=n.width),e.height<n.height&&(e.height=n.height)}this.width<e.width&&this.setWidth(e.width),!this.isColumn&&this.getHeight()<e.height&&this.setHeight(e.height)}}else{for(var s in this.items)this.items[s]._autoResizeBestCellFit(t);for(var s in this.valueItems)this.valueItems[s]._autoResizeBestCellFit(t)}null!=hierarchyHost&&(hierarchyHost._renderRequired=!0)},setWidth:function(t){if(t<0)throw new Exception("Invalid pivotItem Width value. The value must greater than 0");if(null!=this.hierarchy){var e=this.itemColumn;!this.hierarchy.isColumnsHierarchy&&this.hierarchy.compactStyleRenderingEnabled&&(e=0),this.hierarchy._getColumnsCount()<e&&this.hierarchy._updateColumnsCount(),t<this.minimumWidth&&(t=this.minimumWidth),t>this.maximumWidth&&(t=this.maximumWidth),this.isColumn?this.hierarchyItemWidth=t:this.hierarchy.setColumnWidth(e,t),this.hierarchy._renderRequired=!0}},getHeight:function(){return this.isHidden||this.isFiltered?0:this.hierarchyItemHeight},setHeight:function(t){if(t<0||t>1e4)throw new Exception("Invalid pivotItem Height value. The value must be between 0 and 10000");t<this.minimumHeight&&(t=this.minimumHeight),t>this.maximumHeight&&(t=this.maximumHeight),this.hierarchyItemHeight=t,null!=this.hierarchy&&(this.hierarchy._renderRequired=!0)},_calculateHeightWithChildren:function(){if(this.isHidden||this.isFiltered)this.heightWithChildren=0;else{var t=!this.isColumn&&this.hierarchy.compactStyleRenderingEnabled;if(this.isExpanded||this.hasVisibleValueItems()){var e=0;if(this.isColumn){if(e=this.hierarchyItemHeight,h=0,this.isExpanded)for(s=0;s<this.items.length;s++){i=this.items[s].getHeightWithChildren();h<i&&(h=i)}for(s=0;s<this.valueItems.length;s++){var i=this.valueItems[s].getHeightWithChildren();h<i&&(h=i)}h>0&&(e+=h)}else{if(e=t?this.getHeight():0,this.isExpanded)for(s=0;s<this.items.length;s++)this.items[s].isHidden||this.items[s].isFiltered||(e+=this.items[s].getHeightWithChildren());for(var s=0;s<this.valueItems.length;s++)this.valueItems[s].isHidden||this.valueItems[s].isFiltered||(e+=this.valueItems[s].getHeightWithChildren())}this.heightWithChildren=e}else this.heightWithChildren=this.hierarchyItemHeight;this.IsRowDetailsVisible&&(this.heightWithChildren+=this.RowDetailsHeight)}},getHeightWithChildren:function(){return(this.hierarchy._renderRequired||this.isDirty)&&this._calculateHeightWithChildren(),this.heightWithChildren},getDisplayHeight:function(){var t=this.hasVisibleValueItems(),e=0;return this.isColumn?e=this.isExpanded||t?this.getTotalHeight():this.hierarchy.getHeight()-this.y:this.hierarchy.compactStyleRenderingEnabled?(e=this.getHeight(),this.IsRowDetailsVisible&&(e+=this.RowDetailsHeight)):e=this.getHeightWithChildren(),e<this.minimumHeight&&(e=this.minimumHeight),e},getTotalHeight:function(){return this.isHidden||this.isFiltered?0:this.hierarchyItemHeight+(this.IsRowDetailsVisible?this.RowDetailsHeight:0)},ensureVisible:function(){var t=this;if(!t.isVisible()){var e=t.hierarchy.parentPivotGrid.host;if(t.isColumn){var i=e.find("#divHScroll");t.x+t.getWidth()>t.hierarchy.viewPort.width?i.val(t.x+t.getWidth()-t.hierarchy.viewPort.width):i.val(t.x)}else{var s=e.find("#divVScroll");t.y+t.getHeight()>t.hierarchy.viewPort.height?s.val(t.y+t.getHeight()-t.hierarchy.viewPort.height):s.val(t.y)}}},isVisible:function(){return!this.isHidden&&!(this.y<this.hierarchy.viewPort.y-this.hierarchy.y||this.y+this.getDisplayHeight()>this.hierarchy.viewPort.y-this.hierarchy.y+this.hierarchy.viewPort.height||this.x<this.hierarchy.viewPort.x-this.hierarchy.x||this.x+this.getDisplayWidth()>this.hierarchy.viewPort.x-this.hierarchy.x+this.hierarchy.viewPort.width)},_updateVisibleChildItemsCount:function(){for(var t=0,e=0;e<this.items.length;e++)this.items[e].isHidden||this.items[e].isFiltered||t++;this._visibleChildItemsCount=t},render:function(t,e){this._updateVisibleChildItemsCount();if(this.isHidden||this.isFiltered)return!0;this.x=t,this.y=e;var i=!this.isColumn&&this.hierarchy.compactStyleRenderingEnabled,s=i?this.getTotalHeight():0;if(this.isExpanded)for(n=0;n<this.items.length;n++)if(!(o=this.items[n]).isHidden&&!o.isFiltered)if(this.isColumn){if(!o.render(this.x+s,e+this.getTotalHeight()))break;s+=o.getWidthWithChildren()}else{r=t;if(r+=i?0:this.getWidth(),!o.render(r,this.y+s))break;s+=o.getHeightWithChildren()}for(var n=0;n<this.valueItems.length;n++){var o=this.valueItems[n];if(!o.isHidden&&!o.isFiltered)if(this.isColumn){if(!o.render(this.x+s,e+this.getTotalHeight()))break;s+=o.getWidthWithChildren()}else{var r=t;if(r+=i?0:this.getWidth(),!o.render(r,this.y+s))break;s+=o.getHeightWithChildren()}}return this._calculateWidthWithChildren(),this._calculateHeightWithChildren(),!0},_getChildItemsDepth:function(){for(var t=0,e=0;e<this.items.length;e++)(i=this.items[e]._getChildItemsDepth())>t&&(t=i);for(e=0;e<this.valueItems.length;e++){var i=this.valueItems[e]._getChildItemsDepth();i>t&&(t=i)}return t+1},getTotalItemsCount:function(){var t=0;if(0==this.items.length&&0==this.valueItems.length)t=1;else{for(e=0;e<this.items.length;e++)t+=this.items[e].getTotalItemsCount();for(var e=0;e<this.valueItems.length;e++)t+=this.valueItems[e].getTotalItemsCount()}return t},hasVisibleValueItems:function(){for(var t=0;t<this.valueItems.length;t++){var e=this.valueItems[t];if(0==e.isHidden&&0==e.isFiltered)return!0}return!1},getVisibleItemsCount:function(){if(this.isHidden||this.isFiltered)return 0;var t=0;if(!(this.isExpanded&&0!=this.items.length||0!=this.valueItems.length))return t;t=0;for(e=0;e<this.items.length;e++)this.items[e].isHidden||this.items[e].isFiltered||t++;for(var e=0;e<this.valueItems.length;e++)this.valueItems[e].isHidden||this.valueItems[e].isFiltered||t++;return t},hitTest:function(t){if(this.isHidden||this.isFiltered)return null;var e=this.getDisplayHeight()+1,i=this.getDisplayWidth()+1;return t.x>=this.x&&t.x<=this.x+i&&t.y>=this.y&&t.y<=this.y+e?this:null},_expandInternal:function(e,i,s){if(0!=this.items.length&&this.expandCollapseEnabled&&this.isExpanded!=e){var n=new t.Event(this.isExpanded?"pivotitemcollapsing":"pivotitemexpanding");n.owner=this.hierarchy.parentPivotGrid,n.args={pivotItem:this},n.cancel=!1;var o=this.hierarchy.parentPivotGrid.host;if(o.trigger(n),!n.cancel&&(this.isExpanded=e,0!=this.items.length||0!=this.valueItems.length)){if(s){for(r=0;r<this.items.length;r++)this.items[r]._expandInternal(e,i,s);for(var r=0;r<this.valueItems.length;r++)this.valueItems[r]._expandInternal(e,i,s)}this.hierarchy._renderRequired=!0,i&&this.hierarchy._updateVisibleLeaves(),(n=new t.Event(this.isExpanded?"pivotitemexpanded":"pivotitemcollapsed")).owner=this.hierarchy.parentPivotGrid,n.args={pivotItem:this},o.trigger(n)}}},expand:function(){this._expandInternal(!0,!0,!1)},collapse:function(){this._expandInternal(!1,!0,!1)},_getFirstVisibleLeaf:function(t){if(t.isExpanded){for(var e=!1,i=0;i<t.items.length;i++)if(0==t.items[i].isHidden&&0==t.items[i].isFiltered){t=t.items[i],t=this._getFirstVisibleLeaf(t),e=!0;break}if(e)return t}if(t.hasVisibleValueItems){for(var e=!1,i=0;i<t.valueItems.length;i++)if(0==t.valueItems[i].isHidden&&0==t.valueItems[i].isFiltered){t=t.valueItems[i],t=this._getFirstVisibleLeaf(t),e=!0;break}if(e)return t}return t},_getLastVisibleLeaf:function(t){for(var e=!1,i=t.valueItems.length-1;i>=0;i--)if(0==t.valueItems[i].isHidden&&0==t.valueItems[i].isFiltered){t=t.valueItems[i],t=this._getLastVisibleLeaf(t),e=!0;break}if(e)return t;for(i=t.items.length-1;i>=0&&t.isExpanded;i--)if(0==t.items[i].isHidden&&0==t.items[i].isFiltered){t=t.items[i],t=this._getLastVisibleLeaf(t);break}return t}}),t.jqx.jqxPivotGrid.hierarchy=function(){this.parentPivotGrid=arguments[0],this._initDefaults()},t.extend(t.jqx.jqxPivotGrid.hierarchy.prototype,{_initDefaults:function(){this.columnWidths=new Array,this.rowHeights=new Array,this.items=new Array,this.valueItems=new Array,this.visibleLeafItems=new Array,this.viewPort=new Object,this.viewPort.x=0,this.viewPort.y=0,this.viewPort.width=1e4,this.viewPort.height=1e4,this.isFixed=!1,this.isHidden=!1,this.resizable=!0,this.sortable=!0,this._renderRequired=!0,this.maxVisibleLevelDepth=-1,this.showExpandCollapseButtons=!0,this.x=0,this.y=0,this._width=0,this._height=0,this.minColumnWidth=18,this._isColumnsCountRequresUpdate=!0,this._selectedItems=new Object,this.virtualModeThreshold=5e3,this._isVirtualMode=!0},isVisible:function(){return!this.isHidden},toggle:function(){this.isHidden?this.show():this.hide()},getOtherHierarchy:function(){return this.isColumnsHierarchy?this.parentPivotGrid._pivotRows:this.parentPivotGrid._pivotColumns},show:function(){this.isHidden=!1,this._renderRequired=!0,this.getOtherHierarchy()._renderRequired=!0},hide:function(){this.isHidden=!0,this._renderRequired=!0,this.getOtherHierarchy()._renderRequired=!0},refresh:function(){var e=this.parentPivotGrid,i=e.toThemeProperty("jqx-widget-content jqx-fill-state-pressed jqx-widget-header"),s=e.toThemeProperty("jqx-widget-content jqx-fill-state-normal jqx-widget-header"),n=t.jqx.get(this,"renderCanvas");if((this._renderRequired||this._refreshRequired)&&(this._renderRequired&&this.render(),!this.isHidden)){var o=new Array,r=new Date,l=this._getItemsToRender();if(l){for(R=0;R<l.length;R++){var h=l[R],a=h.getDisplayWidth()-1,d=h.getDisplayHeight()-1,u=h._element;if(t.isFunction(e.itemsRenderer)){var c=e.itemsRenderer(h);u&&h._currentCustomContent!=c&&(n.removeChild(u),u=h._element=null),h._currentCustomContent=c}if(!u){var v={left:4,top:4,right:4,bottom:4};!this.isColumnsHierarchy&&this.compactStyleRenderingEnabled&&(v.left+=h.itemLevel*this.compactStyleRenderingItemsIndent);var m=h.text,p="left";if(t.isFunction(e.itemsRenderer))m=h._currentCustomContent,v={left:0,top:0,right:0,bottom:0};else{var _="";0!=h.items.length&&h.hierarchy.showExpandCollapseButtons&&(_=h.isExpanded?"<div style='position: relative; top: 3px; padding: 5px; width: 11px; height: 11px;' class='jqx-pivotgrid-collapse-button'></div>":"<div style='position: relative; top: 3px; padding: 5px; width: 11px; height: 11px;' class='jqx-pivotgrid-expand-button'></div>");var g="";h.hierarchy._sortItem==h&&(g="<div id='sortElement' class='"+("desc"==h.hierarchy._sortOrder?"sortdesc jqx-grid-column-sortdescbutton "+this.parentPivotGrid.toThemeProperty("jqx-icon-arrow-down"):"sortasc jqx-grid-column-sortascbutton "+this.parentPivotGrid.toThemeProperty("jqx-icon-arrow-up"))+"' style='position: relative; float: right; padding-right: 8px; width: 16px; height: 100%;'></div>");var C=h.text;if(h.adapterItem.boundField&&(p=h.adapterItem.boundField.align||"left"),"center"!=(p=p.toString().toLowerCase())&&"right"!=p&&(p="left"),""!=g){var f=0,y=24;""!=_&&(y+=f=23),m=_+"<div><div style='left: "+f+"px; top: 0; position: absolute; height: 100%; width: calc(100% - "+y+"px); text-overflow: ellipsis; overflow: hidden;  white-space: nowrap;padding-left:"+v.left+"px; padding-top:"+v.top+"px; '>"+C+"</div><div style='left: 0; top: 0; position: absolute; height: 100%; width: 100%;'>"+g+"</div></div>"}else m=_+C+g}u=e.createDiv(n,"",a,d),e.setDivContent(u,m,v,p,!0),this.parentPivotGrid.getChild(u,"innerDiv").className="jqx-pivotgrid-item",e.setElementPosition(u,h.x,h.y),u.originalY=u.style.top}h.tRender=r;var x=h.isSelected?i:s,I=h.isSelected?"classNameSelected":"className",S=t.jqx.getByPriority([h[I],h.adapterItem&&h.adapterItem.boundField?h.adapterItem.boundField[I]:void 0,this.hierarchy?this.hierarchy[I]:void 0]);S&&(x+=" "+S),(x+=" jqx-pivotgrid-content-wrapper")!=u.className&&(u.className=x),u.style.display="block",u.item=h,h._element=u}for(var R=0;R<n.childNodes.length;R++)n.childNodes[R].item&&n.childNodes[R].item.tRender!=r&&o.push(n.childNodes[R]);for(;;){var w=o.pop();if(!w)break;n.childNodes.length>100?(w.item._element=void 0,n.removeChild(w)):w.item._element.style.display="none"}var P=this.isColumnsHierarchy?0:-e._offsetY,E=this.isColumnsHierarchy?-e._offsetX:0;e.setElementPosition(n,E,P),this._refreshRequired=!1}}},clear:function(){this._initDefaults(),this._resetCanvas(),this.items=[],this.valueItems=[],this._renderRequired=!0},_resetCanvas:function(){var e=t.jqx.get(this,"renderCanvas");if(e)for(;e.hasChildNodes();)e.firstChild.item._element=void 0,e.removeChild(e.firstChild)},autoResize:function(t){for(e=0;e<this.items.length;e++)this.items[e].autoResize(t);for(var e=0;e<this.valueItems.length;e++)this.valueItems[e].autoResize(t)},getMaxVisibleLevelDepth:function(){if(-1==this.maxVisibleLevelDepth||this._renderRequired){var t=this._getVisibleLeafLevelItems();this.maxVisibleLevelDepth=0;for(var e=0;e<t.length;e++)t[e].itemLevel>this.maxVisibleLevelDepth&&(this.maxVisibleLevelDepth=t[e].itemLevel)}return this.maxVisibleLevelDepth},getHierarchyDepth:function(){for(var t=0,e=0;e<this.items.length;e++)(i=this.items[e]._getChildItemsDepth())>t&&(t=i);for(e=0;e<this.valueItems.length;e++){var i=this.valueItems[e]._getChildItemsDepth();i>t&&(t=i)}return t},getSortItem:function(){return this._sortItem},getSortOrder:function(){return this._sortOrder},_fnAscSortComparer:function(t,e){var i=t.hierarchy.parentPivotGrid,s=(t.isColumn?i._pivotRows:i._pivotColumns)._sortItem;if(!s)return 0;if(t.adapterItem&&t.adapterItem.isTotal)return 1;if(e.adapterItem&&e.adapterItem.isTotal)return-1;var n=i._pivotCells,o=t.isColumn?n.getCellValue(s,t):n.getCellValue(t,s),r=e.isColumn?n.getCellValue(s,e):n.getCellValue(e,s);return o.value-r.value},_fnDescSortComparer:function(e,i){return e.adapterItem&&e.adapterItem.isTotal?1:i.adapterItem&&i.adapterItem.isTotal?-1:-1*t.jqx.jqxPivotGrid.hierarchy.prototype._fnAscSortComparer(e,i)},_collectionSort:function(t,e,i){if(this.parentPivotGrid&&this.parentPivotGrid._pivotCells){var s=this.isColumnsHierarchy?this.parentPivotGrid._pivotRows:this.parentPivotGrid._pivotColumns;t||(t=this.items),e||(e="asc"==s._sortOrder?this._fnAscSortComparer:this._fnDescSortComparer),this._isSorted&&!i&&this._collectionRemoveSort(t);for(var n=0;n<t.length;n++)t[n]._itemOrdinal=n,this._collectionSort(t[n].items,e,!0);t=t.sort(e),i||(this._isSorted=!0,this._renderRequired=!0,s._renderRequired=!0,this._updateVisibleLeaves())}},_collectionRemoveSort:function(t,e){if(this._isSorted){t||(t=this.items);for(var i=new Array(t.length),s=0;s<t.length;s++)i[t[s]._itemOrdinal]=t[s],this._collectionRemoveSort(t[s].items,!0);if(this.items=i,!e){this._renderRequired=!0,this._updateVisibleLeaves(),this.isColumnsHierarchy&&(this._isColumnsCountRequresUpdate=!0),this._isSorted=!1;var n=this.isColumnsHierarchy?this.parentPivotGrid._pivotRows:this.parentPivotGrid._pivotColumns;n._sortItem=void 0,n._sortOrder=void 0,n._renderRequired=!0}}},sortBy:function(e,i){if(e&&e.isColumn!=this.isColumnsHierarchy&&!(e.valueItems.length>0)){var s=new t.Event("sortchanging");s.owner=this.parentPivotGrid,s.args={pivotItem:e,sortOrder:i},s.cancel=!1;var n=this.parentPivotGrid.host;if(n.trigger(s),!s.cancel){this._collectionRemoveSort(this.items);var o=e.isColumn?this.parentPivotGrid._pivotColumns:this.parentPivotGrid._pivotRows;o._sortItem=e,o._sortOrder=i,this._collectionSort(),this.parentPivotGrid._internalRefresh(),(s=new t.Event("sortchanged")).owner=this.parentPivotGrid,s.args={pivotItem:e,sortOrder:i},(n=this.parentPivotGrid.host).trigger(s)}}},removeSort:function(){var e=this==this.parentPivotGrid._pivotColumns?this.parentPivotGrid._pivotRows:this.parentPivotGrid._pivotColumns,i=e._sortItem,s=e._sortOrder,n=new t.Event("sortremoving");n.owner=this.parentPivotGrid,n.args={pivotItem:i,sortOrder:s},n.cancel=!1;var o=this.parentPivotGrid.host;o.trigger(n),n.cancel||(this._collectionRemoveSort(this.items),this.parentPivotGrid._internalRefresh(),(n=new t.Event("sortremoved")).owner=this.parentPivotGrid,n.args={pivotItem:i,sortOrder:s},o.trigger(n))},_binSearchItems:function(t,e){return this._binSearchItems2(t,e,0,t.length)},_binSearchItems2:function(t,e,i,s){var n=i,o=s;if(o==n)return-1;for(var r=t[0].isColumn;n<o;){var l=parseInt((n+o)/2),h=t[l];if(r)if(h.x>e.x)o=l;else{if(!((l+1<o?t[l+1].x:h.x+h.getWidth())<e.x))return l;n=l+1}else if(h.y>e.y)o=l;else{if(!((l+1<o?t[l+1].y:h.y+h.getTotalHeight())<e.y))return l;n=l+1}}return-1},_pointToLeafItemIndex:function(t){this._renderRequired&&this.render();var e={x:t.x,y:t.y};e.x+=-this.x+this.viewPort.x,e.y+=-this.y+this.viewPort.y;var i=this._getVisibleLeafLevelItems();return this._binSearchItems(i,e)},_pointToLeafItem:function(t){var e=this._getVisibleLeafLevelItems(),i=this._pointToLeafItemIndex(t);return-1==i||i<0||i>=e.length?null:(e[i].lfIdx=i,e[i])},_pointToLeafItemIndexAbsolute:function(t){this._renderRequired&&this.render();this.viewPort.x,this.x,this.viewPort.y,this.y;var e={x:t.x,y:t.y};e.x-=this.x-(this.viewPort.x-this.x),e.y-=this.y-(this.viewPort.y-this.y);var i=this._getVisibleLeafLevelItems();return this._binSearchItems(i,e)},_pointToLeafItemAbsolute:function(t){var e=this._getVisibleLeafLevelItems(),i=this._pointToLeafItemIndexAbsolute(t);return-1==i||i<0||i>=e.length?null:(e[i].lfIdx=i,e[i])},_pointInRect:function(t,e){return t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height},hitTest:function(t){this._renderRequired&&this.render();var e=this.viewPort.x-this.x,i=this.viewPort.y-this.y;if(!this._pointInRect({x:t.x+e,y:t.y+i},this.viewPort)||this.isHidden)return null;var s={x:t.x,y:t.y};s.x-=this.x-(this.viewPort.x-this.x),s.y-=this.y-(this.viewPort.y-this.y);var n=this._getVisibleLeafLevelItems(),o=this._binSearchItems(n,s);if(-1==o)return null;var r=n[o],l=r.hitTest(s);if(null!=l)return l;for(;null!=r;)if(null!=(r=r.parentItem)&&null!=(l=r.hitTest(s)))return l;return null},_addColumn:function(t){return t<this.minColumnWidth&&(t=this.minColumnWidth),this.columnWidths.push(t),this.columnWidths.length-1},setColumnWidth:function(t,e){return t>=this.columnWidths.length&&this._updateColumnsCount(t+1),e<this.minColumnWidth&&(e=this.minColumnWidth),t<this.columnWidths.length&&(this.columnWidths[t]=e),this._renderRequired=!0,!0},getColumnWidth:function(t){return t>=this.columnWidths.length?70:this.columnWidths[t]},_getVisibleLeaves:function(t,e,i){if(e.isHidden||e.isFiltered)return!0;if(0==e.items.length&&0==e.valueItems.length)return t.push(e),!0;if(i&&t.push(e),e.isExpanded)for(n=0;n<e.items.length;n++){var s=e.items[n];s.isHidden||s.isFiltered||(e.items.length>0&&s.isExpanded||s.hasVisibleValueItems()?this._getVisibleLeaves(t,s,i):t.push(s))}for(var n=0;n<e.valueItems.length;n++){var o=e.valueItems[n];o.isHidden||o.isFiltered||t.push(o)}return!0},_getVisibleLeafLevelItems:function(){return 0==this.visibleLeafItems.length&&this._updateVisibleLeaves(),this.visibleLeafItems},_updateVisibleLeaves:function(){if(this.visibleLeafItems=new Array,this.items.length+this.valueItems.length!=0){for(var t=!this.isColumnsHierarchy&&this.compactStyleRenderingEnabled,e=0;e<this.items.length;e++)(i=this.items[e]).isHidden||i.isFiltered||(i.isExpanded||i.hasVisibleValueItems()?this._getVisibleLeaves(this.visibleLeafItems,i,t):this.visibleLeafItems.push(i));for(e=0;e<this.valueItems.length;e++){var i=this.valueItems[e];i.isHidden||i.isFiltered||(i.isExpanded||i.hasVisibleValueItems()?this._getVisibleLeaves(this.visibleLeafItems,i,t):this.visibleLeafItems.push(i))}for(e=0;e<this.visibleLeafItems.length;e++)this.visibleLeafItems[e]._lfIndex=e;this._updateItemsLevelAndColumn()}},_getFirstLeafIndexToRender:function(){var t={x:this.x,y:this.y},e={x:t.x,y:t.y};return e.x-=this.x-(this.viewPort.x-this.x),e.y-=this.y-(this.viewPort.y-this.y),this._binSearchItems(this._getVisibleLeafLevelItems(),e)},_getLastLeafIndexToRender:function(){var t={x:Math.min(this.viewPort.width,this.getWidth())-5,y:Math.min(this.viewPort.height,this.getHeight())-5};return this._pointToLeafItemIndex(t)},_getLeafItemsToRender:function(){var t={};return t.items=this._getVisibleLeafLevelItems(),t.first=this._getFirstLeafIndexToRender(),t.last=this._getLastLeafIndexToRender(),t},_getItemsToRender:function(){var t=this._getLeafItemsToRender(),e=t.first,i=t.last;if(-1!=e&&-1!=i){var s={};for(r=e;r<=i;r++){var n=t.items[r];for(s[n.id]=n;null!=n.parentItem;)s[(n=n.parentItem).id]=n}var o=new Array;for(var r in s)o.push(s[r]);return o}},_updateItemsLevelAndColumn2:function(t,e){t.itemColumn=e,t.itemLevel=e;for(i=0;i<t.items.length;i++)this._updateItemsLevelAndColumn2(t.items[i],e+1);for(var i=0;i<t.valueItems.length;i++)this._updateItemsLevelAndColumn2(t.valueItems[i],e+1)},_updateItemsLevelAndColumn:function(){for(t=0;t<this.items.length;t++)this._updateItemsLevelAndColumn2(this.items[t],0);for(var t=0;t<this.valueItems.length;t++)this._updateItemsLevelAndColumn2(this.valueItems[t],0)},updateColumnsCount:function(){this.updateColumnsCount(0)},getTotalItemsCount:function(){var t=0;if(0==this.items.length&&0==this.valueItems.length)t=1;else{for(e=0;e<this.items.length;e++)t+=this.items[e].getTotalItemsCount();for(var e=0;e<this.valueItems.length;e++)t+=this.valueItems[e].getTotalItemsCount()}return t},_updateColumnsCount:function(t){var e=this._getColumnsCount(),i=this.getTotalItemsCount();if(t>1024&&(t=1024),this.isColumnsHierarchy)t>i&&(i=t);else{var s=this.getHierarchyDepth();i=t>s?desi:s}for(var n=e;n<i;n++)this._addColumn(70);this._isColumnsCountRequresUpdate=!1},_updateColumnsIndexes:function(){for(var t in this.items)this._updateItemsLevelAndColumn2(this.items[t],0);for(var t in this.valueItems)this._updateItemsLevelAndColumn2(this.valueItems[t],0)},_getColumnsCount:function(){return this.columnWidths.length},_getRenderedItems:function(){var t=new Array;return this._getChildItemsToRender(t),t},_getChildItemsToRender:function(t){for(var e=0;e<this.items.length;e++){var i=this.items[e];i.isHidden||i.isFiltered||(t.push(i),i.isExpanded&&i._getChildItemsToRender(t))}},getWidth:function(){return this._renderRequired&&this.render(),this._width},getHeight:function(){return this._renderRequired&&this.render(),this._height},_beginSelectionUpdate:function(){for(var t in this._selectedItems)this._selectedItems[t].OldIsSelected=this._selectedItems[t].isSelected},_endSelectionUpdate:function(){var e=new Array;for(var i in this._selectedItems){var s=this._selectedItems[i];if(s.isSelected||e.push(this._selectedItems[i]),s.isSelected!=s.OldIsSelected&&(null==s.parentItem||1==s.parentItem.isExpanded||s._isValueItem)){var n=new t.Event("pivotitemselectionchanged");n.owner=this.parentPivotGrid,n.args={pivotItem:s,selected:s.isSelected},this.parentPivotGrid.host.trigger(n)}}for(var i in e){var o=this._selectedItems[e[i].adapterItem.key];o.isSelected=o.OldIsSelected=!1,delete this._selectedItems[e[i].adapterItem.key]}},selectItem:function(t){this.parentPivotGrid.selectionEnabled&&(this._beginSelectionUpdate(),this._internalSelectItem(t),this._endSelectionUpdate())},_internalSelectItem:function(t){if(null!=t&&!(t.isColumn!=this.isColumnsHierarchy||this.isColumnsHierarchy&&this.isGroupingColumn(t))){var e=t.adapterItem.key;if(void 0==this._selectedItems[e]&&(this._selectedItems[e]=t),t.isSelected=!0,this._refreshRequired=!0,this.parentPivotGrid._pivotCells._refreshRequired=!0,this.isColumnsHierarchy||!t.hierarchy.compactStyleRenderingEnabled){for(var i in t.items)this._internalSelectItem(t.items[i]);for(var i in t.valueItems)this._internalSelectItem(t.valueItems[i])}}},unselectItem:function(t){this._beginSelectionUpdate(),this._internalUnselectItem(t),this._endSelectionUpdate()},_internalUnselectItem:function(t){if(null!=t&&t.isColumn==this.isColumnsHierarchy){var e=t.adapterItem.key;if(this._selectedItems[e]&&(this._selectedItems[e].isSelected=!1,this._refreshRequired=!0,this.parentPivotGrid._pivotCells._refreshRequired=!0),this.isColumnsHierarchy||!t.hierarchy.compactStyleRenderingEnabled){for(var i in t.items)this._internalUnselectItem(t.items[i]);for(var i in t.valueItems)this._internalUnselectItem(t.valueItems[i])}}},_internalClearSelection:function(){for(var t in this._selectedItems)this._internalUnselectItem(this._selectedItems[t])},clearSelection:function(){this._beginSelectionUpdate(),this._internalClearSelection(),this._endSelectionUpdate()},_applySelectionToParentItem:function(t){var e=t.parentItem;if(void 0!=e&&null!=e){var i=t.hierarchy,s=!0;if(e.isExpanded)for(var n in e.items)if(0==(o=e.items[n]).isSelected&&0==o.isHidden){s=!1;break}if(s)for(var n in e.valueItems){var o=e.valueItems[n];if(0==o.isSelected&&0==o.isHidden){s=!1;break}}if(s){var r=e.adapterItem.key;void 0==i._selectedItems[r]&&(i._selectedItems[r]=e),e.isSelected=!0,this._applySelectionToParentItem(e)}}},_applySelectionToParentItems:function(){for(var t in this._selectedItems)this._applySelectionToParentItem(this._selectedItems[t])},getSelectedItems:function(){var t=new Array;for(var e in this._selectedItems)this._selectedItems[e].isSelected&&t.push(e);return t}}),t.jqx.jqxPivotGrid.pivotRows=function(e){t.extend(this,new t.jqx.jqxPivotGrid.hierarchy),this.parentPivotGrid=e,this.isColumnsHierarchy=!1,this.compactStyleRenderingEnabled=!1,this.compactStyleRenderingItemsIndent=20},t.extend(t.jqx.jqxPivotGrid.pivotRows.prototype,t.jqx.jqxPivotGrid.hierarchy.prototype),t.extend(t.jqx.jqxPivotGrid.pivotRows.prototype,{setColumnWidth:function(t,e){return t>=this.columnWidths.Count&&this._updateColumnsCount(t+1),this.compactStyleRenderingEnabled&&(t=0),t<this.columnWidths.length&&(this.columnWidths[t]=e),this._renderRequired=!0,!0},updateBounds:function(){for(var t=0,e=0,i=0;i<2;i++)for(var s=0==i?this.items:this.valueItems,n=0;n<s.length;n++){var o=s[n];if(!o.isHidden){t+=o.getHeightWithChildren();var r=o.getWidthWithChildren();e<r&&(e=r)}}this._width=e,this._height=t+1},render:function(){if(!this._renderSuppressed){for(this._refreshRequired=!0,this.parentPivotGrid._pivotCells._refreshRequired=!0,this.isRendering=!0,this._isColumnsCountRequresUpdate&&this._updateColumnsCount();this._getColumnsCount()<this.getHierarchyDepth();)t.jqx.get(this,"columnWidths").push(70);if(this._updateVisibleLeaves(),this.compactStyleRenderingEnabled){0==this.columnWidths.Count&&this._addColumn(70);var e=this.columnWidths[0],i=this.getHierarchyDepth();e<i*this.compactStyleRenderingItemsIndent&&(e=i*this.compactStyleRenderingItemsIndent),this.columnWidths[0]=e}this.updateBounds();var s=0;if(this.items.length+this.valueItems.length==0)return null!=this.parentPivotGrid&&(this.parentPivotGrid.isSyncScrollRequired=!0),this.isRendering=!1,void(this._renderRequired=!1);for(var n=0;n<2;n++)for(var o=0==n?this.items:this.valueItems,r=0;r<o.length;r++){var l=o[r];if(null==l.hierarchy&&(l.hierarchy=this),!l.isHidden){var h=l.getHeightWithChildren();if(l.itemLevel<this.columnWidths.length&&l.getWidth()>this.columnWidths[l.itemLevel]&&(this.columnWidths[l.itemLevel]=l.getWidth()),!l.render(0,s))break;s+=h}}this.updateBounds(),null!=this.parentPivotGrid&&(this.parentPivotGrid.isSyncScrollRequired=!0),this._resetCanvas(),this._renderRequired=!1,this.isRendering=!1}},isOnRowDetails:function(t,e){if(!e.RowDetailsVisible)return!1;var i={x:t.x,y:t.y};return i.x+=-this.x+this.viewPort.x,i.y+=-this.y+this.viewPort.y,i.y<e.y+e.getDisplayHeight()&&i.y>e.y+e.getDisplayHeight()-e.RowDetailsHeight}}),t.jqx.jqxPivotGrid.pivotColumns=function(e){t.extend(this,new t.jqx.jqxPivotGrid.hierarchy),this.parentPivotGrid=e,this.isColumnsHierarchy=!0},t.extend(t.jqx.jqxPivotGrid.pivotColumns.prototype,t.jqx.jqxPivotGrid.hierarchy.prototype),t.extend(t.jqx.jqxPivotGrid.pivotColumns.prototype,{render:function(){if(!this._renderSuppressed){if(this._refreshRequired=!0,this.parentPivotGrid._pivotCells._refreshRequired=!0,this._updateVisibleLeaves(),this._updateColumnsIndexes(),this.items.length+this.valueItems.length==0)return null!=this.parentPivotGrid&&(this.parentPivotGrid.isSyncScrollRequired=!0),void this._updateVisibleLeaves();for(var t=0,e=0;e<2;e++)for(var i=0==e?this.items:this.valueItems,s=0;s<i.length;s++){var n=i[s];if(null==n.hierarchy&&(n.hierarchy=this),!n.isHidden){var o=n.getWidthWithChildren();if(!n.render(t,0))break;t+=o}}this._renderRequired=!1,null!=this.parentPivotGrid&&(this.parentPivotGrid.isSyncScrollRequired=!0),this._updateVisibleLeaves(),this.updateBounds(),this._resetCanvas()}},updateBounds:function(){for(var t=0,e=0,i=0;i<2;i++)for(var s=0==i?this.items:this.valueItems,n=0;n<s.length;n++){var o=s[n],r=o.getHeightWithChildren();t<r&&(t=r),e+=o.getWidthWithChildren()}this._height=t,this._width=e+1},_updateColumnsIndexes:function(){for(var t=this.visibleLeafItems.length,e=--t;e>=0;e--){var i=this.visibleLeafItems[e];i.itemColumn=e;for(var s=i.parentItem;null!=s;)s.hierarchy!=i.hierarchy?s=null:(s.itemColumn=e,s=(i=s).parentItem)}},setRowHeight:function(t,e){return!(e<15||e>500)&&(t.hierarchyItemHeight=e,this._renderRequired=!0,!0)},isGroupingColumn:function(t){return null!=t&&(null!=this.parentPivotGrid&&!!(t.ItemIndex<this.parentPivotGrid.groupingColumns.length&&this.parentPivotGrid.isGroupingEnabled))}})}(jqxBaseFramework),function(t){t.extend(t.jqx._jqxPivotGrid.prototype,{_handleKeyboardNavigation:function(t){return"CELLS_SELECT"==this._internalSelectMode?this._handleCellsKeyboardNavigation(t):("ROW_SELECT"==this._internalSelectMode||this._internalSelectMode,!1)},_handleCellsKeyboardNavigation:function(t){var e=this._cellKBRangeSelectionEnd,i=void 0;if(!e)return!1;if(37==t.keyCode&&(i=this._pivotCells.getNextCell(e,"left")),38==t.keyCode?i=this._pivotCells.getNextCell(e,"top"):39==t.keyCode?i=this._pivotCells.getNextCell(e,"right"):40==t.keyCode&&(i=this._pivotCells.getNextCell(e,"bottom")),null!=i){this._pivotRows._refreshRequired=!0,this._pivotColumns._refreshRequired=!0,this._pivotCells._refreshRequired=!0,this._colItemRangeSelectionBeg=i.pivotColumn,this._rowItemRangeSelectionBeg=i.pivotRow,this._beginSelectionUpdate(),this._isCTRLPressed&&0!=this.multipleSelectionEnabled||this._internalClearSelection(),this._pivotCells._internalSelectCell(this._rowItemRangeSelectionBeg,this._colItemRangeSelectionBeg),this._cellKBRangeSelectionEnd={pivotRow:this._rowItemRangeSelectionBeg,pivotColumn:this._colItemRangeSelectionBeg,pivotCells:this._pivotCells},this._cellKBRangeSelectionStart&&this._isSHIFTPressed||(this._cellKBRangeSelectionStart={pivotRow:this._rowItemRangeSelectionBeg,pivotColumn:this._colItemRangeSelectionBeg,pivotCells:this._pivotCells});for(var s=Math.min(this._cellKBRangeSelectionStart.pivotColumn._lfIndex,this._cellKBRangeSelectionEnd.pivotColumn._lfIndex),n=Math.max(this._cellKBRangeSelectionStart.pivotColumn._lfIndex,this._cellKBRangeSelectionEnd.pivotColumn._lfIndex),o=Math.min(this._cellKBRangeSelectionStart.pivotRow._lfIndex,this._cellKBRangeSelectionEnd.pivotRow._lfIndex),r=Math.max(this._cellKBRangeSelectionStart.pivotRow._lfIndex,this._cellKBRangeSelectionEnd.pivotRow._lfIndex),l=s;l<=n;l++)for(var h=o;h<=r;h++){var a=this._pivotColumns.visibleLeafItems[l],d=this._pivotRows.visibleLeafItems[h];this._pivotCells._internalSelectCell(d,a)}this._endSelectionUpdate(),i.pivotRow.ensureVisible(),i.pivotColumn.ensureVisible(),this._internalRefresh()}return!1}})}(jqxBaseFramework);

