/*
jQWidgets v5.1.0 (2017-Aug)
Copyright (c) 2011-2017 jQWidgets.
License: http://jqwidgets.com/license/
*/
!function(e){e.extend(e.jqx._jqxGrid.prototype,{_handledblclick:function(t,i){if(null!=t.target&&!i.disabled&&!e(t.target).ischildof(this.columnsheader)){var l;if(t.which?l=3==t.which:t.button&&(l=2==t.button),!l){var o;if(t.which?o=2==t.which:t.button&&(o=1==t.button),!o){var d=this.showheader?this.columnsheader.height()+2:0,s=this._groupsheader()?this.groupsheader.height():0;s+=this.showtoolbar?this.toolbarheight:0;var a=this.host.offset(),r=t.pageX-a.left,n=t.pageY-d-a.top-s,c=this._hittestrow(r,n);if(c){var h=c.row,u=c.index,p=t.target.className,f=this.table[0].rows[u];if(null!=f){i.mousecaptured=!0,i.mousecaptureposition={left:t.pageX,top:t.pageY-s};for(var v=this.hScrollInstance.value,m=0,x=(this.groupable&&this.groups.length,0);x<f.cells.length;x++){var w=parseInt(e(this.columnsrow[0].cells[x]).css("left")),b=w-v;if(i.columns.records[x].pinned&&(b=w),(null==(g=this._getcolumnat(x))||!g.hidden)&&b+e(this.columnsrow[0].cells[x]).width()>=r&&r>=b){m=x;break}}if(null!=h){var g=this._getcolumnat(m);-1==p.indexOf("jqx-grid-group-expand")&&-1==p.indexOf("jqx-grid-group-collapse")&&-1!=h.boundindex&&i.begincelledit(i.getboundindex(h),g.datafield,g.defaulteditorvalue)}}}}}}},_getpreveditablecolumn:function(e){for(var t=this;e>0;){e--;var i=t.getcolumnat(e);if(!i)return null;if(i.editable&&!i.hidden)return i}return null},_getnexteditablecolumn:function(e){for(var t=this;e<this.columns.records.length;){e++;var i=t.getcolumnat(e);if(!i)return null;if(i.editable&&!i.hidden)return i}return null},_handleeditkeydown:function(t,i){if(i.handlekeyboardnavigation&&1==i.handlekeyboardnavigation(t))return!0;var l=t.charCode?t.charCode:t.keyCode?t.keyCode:0;if(i.editEvent=t,i.showfilterrow&&i.filterable&&this.filterrow&&e(t.target).ischildof(this.filterrow))return!0;if(t.target.className&&t.target.className.indexOf("jqx-grid-widget")>=0)return!0;if(i.pageable&&e(t.target).ischildof(this.pager))return!0;if(this.showtoolbar&&e(t.target).ischildof(this.toolbar))return!0;if(this.showeverpresentrow){if(this.addnewrowtop&&e(t.target).ischildof(this.addnewrowtop))return!0;if(this.addnewrowbottom&&e(t.target).ischildof(this.addnewrowbottom))return!0}if(this.showstatusbar&&e(t.target).ischildof(this.statusbar))return!0;if(this.rowdetails&&e(t.target).ischildof(this.content.find("[role='rowgroup']")))return!0;if(this.editcell){if("selectedrow"===this.editmode){if(13===l)return this.endrowedit(this.editcell.row,!1),!1;if(27===l)return this.endrowedit(this.editcell.row,!0),!1;if(32==l&&this._currentColumn&&"checkbox"==this.getcolumn(this._currentColumn).columntype&&(L=this.getcolumn(this._currentColumn)).editable){var o=!this.getcellvalue(this.editcell.row,L.datafield),d=this.getrowdata(this.editcell.row),s=this.editcell.row,d=i.getrowdata(i.editcell.row);this.setcellvalue(this.editcell.row,L.datafield,o,!1);var a=this._focusedColumn,r=this._currentColumn,n=this._currentEditableColumn;if(this.endrowedit(this.editcell.row,!1),this.beginrowedit(s,!1),this._currentColumn=r,this._focusedColumn=a,this._currentEditableColumn=n,this._renderrows(),this.selectcell(s,L.datafield),this._oldselectedcell=this.selectedcell,a){var c=this;setTimeout(function(){c.selectcell(s,L.datafield),c._oldselectedcell=c.selectedcell,e(c._checkboxCells[L.datafield].checkbox).jqxCheckBox("focus")},25)}return!1}if(9===l){var h=this.editcell.datafield,u=this._getcolumnindex(h);this._currentEditableColumn?u=this._currentEditableColumn:this._currentEditableColumn=u;L=this._getnexteditablecolumn(u);if(t.shiftKey&&(L=this._getpreveditablecolumn(u)),L){u=this._getcolumnindex(L.datafield);if(this.editcell[L.datafield])this._currentEditableColumn=u,(p=this.editcell[L.datafield].editor)&&(p.data().jqxWidget&&p.data().jqxWidget.focus?p.data().jqxWidget.focus():p.focus()),this._focusedColumn=L.datafield,this._currentColumn=L.datafield;else if("checkbox"==L.columntype)return this._currentColumn=L.datafield,this._currentEditableColumn=u,this.selectcell(this.editcell.row,L.datafield),this._oldselectedcell=this.selectedcell,this._checkboxCells[L.datafield]&&e(this._checkboxCells[L.datafield].checkbox).jqxCheckBox("focus"),!1}return!1}return!0}if(null==this.editcell.columntype||"textbox"==this.editcell.columntype||"numberinput"==this.editcell.columntype||"combobox"==this.editcell.columntype||"datetimeinput"==this.editcell.columntype){if(l>=33&&l<=40&&"multiplecellsadvanced"==i.selectionmode){var p="textbox"==this.editcell.columntype||null==this.editcell.columntype?this.editcell.editor:this.editcell.editor.find("input"),f=i._selection(p),v=p.val().length;f.length>0&&"datetimeinput"!=this.editcell.columntype&&(i._cancelkeydown=!0),f.start>0&&37==l&&(i._cancelkeydown=!0),f.start<v&&39==l&&"datetimeinput"!=this.editcell.columntype&&(i._cancelkeydown=!0),"datetimeinput"==this.editcell.columntype&&39==l&&f.start+f.length<v&&(i._cancelkeydown=!0)}}else"dropdownlist"==this.editcell.columntype?(37==l||39==l&&"multiplecellsadvanced"==i.selectionmode)&&(i._cancelkeydown=!1):"multiplecellsadvanced"==this.selectionmode&&"textbox"!=this.editcell.columntype&&"numberinput"!=this.editcell.columntype&&(i._cancelkeydown=!0);if(32==l&&"checkbox"==i.editcell.columntype&&(L=i.getcolumn(i.editcell.datafield)).editable){o=!i.getcellvalue(i.editcell.row,i.editcell.column);if(L.cellbeginedit&&0==(P=L.cellbeginedit(i.editcell.row,L.datafield,L.columntype,!o)))return!1;d=i.getrowdata(i.editcell.row);return i.setcellvalue(i.editcell.row,i.editcell.column,o,!0),i._raiseEvent(18,{rowindex:i.editcell.row,row:d,datafield:i.editcell.column,oldvalue:!o,value:o,columntype:"checkbox"}),!1}if(9==l){var m=this.editcell.row,x=h=this.editcell.column,u=i._getcolumnindex(h),w=!1,b=i.getrowvisibleindex(m);this.editchar="";g=this.editcell.validated;if(!this.editcell.validated)var g=this.endcelledit(this.editcell.row,this.editcell.column,!1,!0,!1);if(0!=g){if(t.shiftKey)if(L=i._getpreveditablecolumn(u))h=L.datafield,w=!0,-1!=i.selectionmode.indexOf("cell")&&(i.selectprevcell(m,x),i._oldselectedcell=i.selectedcell,setTimeout(function(){i.ensurecellvisible(b,h)},10));else{var y=i._getlastvisiblecolumn();w=!0,h=y.displayfield,m--,-1!=i.selectionmode.indexOf("cell")&&(i.clearselection(),i.selectcell(m,h),i._oldselectedcell=i.selectedcell,setTimeout(function(){i.ensurecellvisible(b,h)},10))}else if(L=i._getnexteditablecolumn(u))h=L.datafield,w=!0,-1!=i.selectionmode.indexOf("cell")&&(i.selectnextcell(m,x),i._oldselectedcell=i.selectedcell,setTimeout(function(){i.ensurecellvisible(b,h)},10));else{var _=i._getfirstvisiblecolumn();w=!0,h=_.displayfield,m++,-1!=i.selectionmode.indexOf("cell")&&(i.clearselection(),i.selectcell(m,h),i._oldselectedcell=i.selectedcell,setTimeout(function(){i.ensurecellvisible(b,h)},10))}if(!w)return null!=this.editcell&&(i.endcelledit(m,h,!1),this._renderrows(this.virtualsizeinfo)),!0;i.begincelledit(m,h),null!=this.editcell&&"checkbox"==this.editcell.columntype&&this._renderrows(this.virtualsizeinfo)}return!1}if(13==l){var q=this.selectedcell;if(q)var j=this.getrowvisibleindex(q.rowindex);if(this.endcelledit(this.editcell.row,this.editcell.column,!1,!0),"multiplecellsadvanced"==this.selectionmode&&null!=(z=i.getselectedcell())&&i.selectcell&&null==this.editcell&&z.rowindex+1<this.dataview.totalrecords)if(this.sortcolumn!=z.datafield){b=this.getrowvisibleindex(z.rowindex);if((B=this.dataview.loadedrecords[b+1])&&(!this.pageable||this.pageable&&b+1<(this.dataview.pagenum+1)*this.pagesize)){this.clearselection(!1),this.selectcell(this.getboundindex(B),z.datafield);z=this.getselectedcell();this.ensurecellvisible(B.visibleindex,z.datafield)}}else if(null!=q&&(I=this.dataview.loadedrecords[j+1]))if(!this.pageable||this.pageable&&j+1<this.pagesize)this.clearselection(!1),this.selectcell(this.getboundindex(I),z.datafield);else if(this.pageable&&j+1>=this.pagesize){this.clearselection(!1);var I=this.dataview.loadedrecords[j];this.selectcell(this.getboundindex(I),z.datafield)}return!1}if(27==l)return this.endcelledit(this.editcell.row,this.editcell.column,!0,!0),!1}else{var D=!1;if(113==l&&(D=!0),!t.ctrlKey&&!t.altKey&&!t.metaKey){if(l>=48&&l<=57&&(this.editchar=String.fromCharCode(l),D=!0),189===l&&(D=!0),l>=65&&l<=90){this.editchar=String.fromCharCode(l);var C=!1;t.shiftKey?C=t.shiftKey:t.modifiers&&(C=!!(4&t.modifiers)),this._capsLock&&(C=!C),C||(this.editchar=this.editchar.toLowerCase()),D=!0}else l>=96&&l<=105&&(this.editchar=l-96,this.editchar=this.editchar.toString(),D=!0);var k=e(".jqx-grid").length;D=D&&(1==k||k>1&&i.focused);var T=e.data(document.body,"jqxgrid.edit");if(void 0!==T&&""!==T&&(13===l||D)&&T!=i.element.id)return!0}if((13==l||D)&&i.getselectedrowindex){m=i.getselectedrowindex();if("selectedrow"===i.editmode){if(!(m>=0)){if(null!=(z=i.getselectedcell())){L=i._getcolumnbydatafield(z.datafield);i.beginrowedit(z.rowindex)}return!1}i.beginrowedit(m)}switch(i.selectionmode){case"singlerow":case"multiplerows":case"multiplerowsextended":if(m>=0){for(var h="",S=0;S<i.columns.records.length;S++)if((L=i.getcolumnat(S)).editable){h=L.datafield;break}"selectedrow"===i.editmode?i.beginrowedit(m):i.begincelledit(m,h)}break;case"singlecell":case"multiplecells":case"multiplecellsextended":if(null!=(z=i.getselectedcell())){L=i._getcolumnbydatafield(z.datafield);"selectedrow"===i.editmode?i.beginrowedit(z.rowindex):"checkbox"!=L.columntype&&i.begincelledit(z.rowindex,z.datafield)}break;case"multiplecellsadvanced":if(null!=(z=i.getselectedcell()))if(13==l){if(i.selectcell&&(b=this.getrowvisibleindex(z.rowindex))+1<i.dataview.totalrecords){var B=this.dataview.loadedrecords[b+1];if(B){this.clearselection(!1),this.selectcell(this.getboundindex(B),z.datafield);var z=this.getselectedcell();this.ensurecellvisible(B.visibleindex,z.datafield)}}}else"selectedrow"!==i.editmode&&i.begincelledit(z.rowindex,z.datafield)}return!1}if(46==l){var O=i.getselectedcells();if(-1==i.selectionmode.indexOf("cell")&&i._getcellsforcopypaste&&(O=i._getcellsforcopypaste()),null!=O&&O.length>0){for(var N=0;N<O.length;N++)if((z=O[N]).datafield){var L=i.getcolumn(z.datafield),E=i.getcellvalue(z.rowindex,z.datafield);if(""!==E&&L.editable&&i.enablekeyboarddelete){var H=null;if("checkbox"==L.columntype&&(L.threestatecheckbox||(H=!1)),L.cellbeginedit&&0==(P=L.cellbeginedit(z.rowindex,L.datafield,L.columntype,H)))return!1;d=i.getrowdata(z.rowindex);if(i._raiseEvent(17,{rowindex:z.rowindex,row:d,datafield:z.datafield,value:E}),N==O.length-1?(i.setcellvalue(z.rowindex,z.datafield,H,!0),L.displayfield!=L.datafield&&i.setcellvalue(z.rowindex,L.displayfield,H,!0)):(i.setcellvalue(z.rowindex,z.datafield,H,!1),L.displayfield!=L.datafield&&i.setcellvalue(z.rowindex,L.displayfield,H,!0)),L.cellendedit)L.cellendedit(z.rowindex,L.datafield,L.columntype,H);i._raiseEvent(18,{rowindex:z.rowindex,row:d,datafield:z.datafield,oldvalue:E,value:H})}}return this.dataview.updateview(),this._renderrows(this.virtualsizeinfo),!1}}if(32==l&&null!=(z=i.getselectedcell())&&"checkbox"==(L=i.getcolumn(z.datafield)).columntype&&L.editable){o=!i.getcellvalue(z.rowindex,z.datafield);if(L.cellbeginedit){var P=L.cellbeginedit(z.rowindex,L.datafield,L.columntype,!o);if(0==P)return!1}d=i.getrowdata(z.rowindex);return i._raiseEvent(17,{rowindex:z.rowindex,row:d,datafield:z.datafield,value:!o,columntype:"checkbox"}),i.setcellvalue(z.rowindex,z.datafield,o,!0),i._raiseEvent(18,{rowindex:z.rowindex,row:d,datafield:z.datafield,oldvalue:!o,value:o,columntype:"checkbox"}),!1}}return!0},begincelledit:function(t,i,l,o,d){var s=this.getcolumn(i);if(this._cellscache=new Array,null!=i&&"number"!=s.columntype&&"button"!=s.columntype&&!s.createwidget){if(this.groupable){if(this.groups.indexOf(i)>=0)return;if(this.groups.indexOf(s.displayfield)>=0)return}if(void 0==this.editrow){if(this.editcell){if(this.editcell.row==t&&this.editcell.column==i)return!0;if("selectedrow"===this.editmode&&this.editcell.row==t)return;if(0==this.endcelledit(this.editcell.row,this.editcell.column,!1,!0,!1))return}var a="checkbox"==s.columntype||"button"==s.columntype||s.createwidget;if(this.host.removeClass("jqx-disableselect"),this.content.removeClass("jqx-disableselect"),s.editable){if(s.cellbeginedit){var r=this.getcell(t,i);if(0==s.cellbeginedit(t,i,s.columntype,null!=r?r.value:null))return}var n=this.getrowvisibleindex(t);if(this.editcell=this.getcell(t,i),this.editcell&&(this.editcell.visiblerowindex=n,!this.editcell.editing)){if(a||(this.editcell.editing=!0),this.editcell.columntype=s.columntype,this.editcell.defaultvalue=l,void 0!=s.defaultvalue&&(this.editcell.defaultvalue=s.defaultvalue),this.editcell.init=!0,"checkbox"!=s.columntype&&"selectedrow"!=this.editmode){var c=this.getrowdata(t);this._raiseEvent(17,{rowindex:t,row:c,datafield:s.datafield,value:this.editcell.value,columntype:s.columntype})}if(e.data(document.body,"jqxgrid.edit",this.element.id),!a){var h=this.getrowvisibleindex(t);!1!==o&&(this.autorowheight||this.ensurecellvisible(h,s.datafield)),!1!==d&&this._renderrows(this.virtualsizeinfo)}if(this.editcell)return this.editcell.init=!1,!0}}else{if(!this.editcell)return;this.editcell.editor=null,this.editcell.editing=!1,!1!==d&&this._renderrows(this.virtualsizeinfo),this.editcell=null}}}},getScrollTop:function(){if(this._py)return pageYOffset;if(this._py="undefined"!=typeof pageYOffset,this._py)return pageYOffset;var e=document.body,t=document.documentElement;return(t=t.clientHeight?t:e).scrollTop},getScrollLeft:function(){if("undefined"!=typeof pageXOffset)return pageXOffset;var e=document.body,t=document.documentElement;return(t=t.clientHeight?t:e).scrollLeft},endcelledit:function(t,i,l,o,d){if(void 0!=t&&void 0!=i||(this.editcell&&(t=this.editcell.row,i=this.editcell.column),void 0==l&&(l=!0)),this.editcell){var s=this.getcolumn(i),a=this;if("selectedrow"!==a.editmode){var r=function(){if(0!=d){if(a.isTouchDevice())return;if(!a.isNestedGrid){var e=a.getScrollTop(),t=a.getScrollLeft();try{a.element.focus(),a.content.focus(),e!=a.getScrollTop()&&window.scrollTo(t,e),setTimeout(function(){a.element.focus(),a.content.focus(),e!=a.getScrollTop()&&window.scrollTo(t,e)},10)}catch(e){}}}};if("checkbox"==s.columntype||"button"==s.columntype||s.createwidget)return this.editcell&&(this.editcell.editor=null,this.editcell.editing=!1,this.editcell=null),!0;var n=this._geteditorvalue(s),c=function(e){if(e._hidecelleditor(),s.cellendedit&&s.cellendedit(t,i,s.columntype,e.editcell.value,n),e.editchar=null,s.displayfield!=s.datafield){var l=e.getcellvalue(e.editcell.row,s.displayfield),d=e.editcell.value;oldvalue={value:d,label:l}}else oldvalue=e.editcell.value;var a=e.getrowdata(t);e._raiseEvent(18,{rowindex:t,row:a,datafield:i,displayfield:s.displayfield,oldvalue:n,value:n,columntype:s.columntype}),e.editcell.editor=null,e.editcell.editing=!1,e.editcell=null,(o||void 0==o)&&e._renderrows(e.virtualsizeinfo),r(),e.enablebrowserselection||(e.host.addClass("jqx-disableselect"),e.content.addClass("jqx-disableselect"))};if(l)return c(this),!1;if(this.validationpopup&&(this.validationpopup.hide(),this.validationpopuparrow.hide()),s.cellvaluechanging){var h=s.cellvaluechanging(t,i,s.columntype,this.editcell.value,n);void 0!=h&&(n=h)}if(s.validation){var u=this.getcell(t,i);try{var p=s.validation(u,n),f=this.gridlocalization.validationstring;if(void 0!=p.message&&(f=p.message),!("boolean"==typeof p?p:p.result))return void 0!=p.showmessage&&1!=p.showmessage||this._showvalidationpopup(t,i,f),this.editcell.validated=!1,!1}catch(e){return this._showvalidationpopup(t,i,this.gridlocalization.validationstring),this.editcell.validated=!1,!1}}if(s.displayfield!=s.datafield){var v=this.getcellvalue(this.editcell.row,s.displayfield),m=this.editcell.value;oldvalue={value:m,label:v}}else oldvalue=this.editcell.value;var x=this.getrowdata(t);return s.cellendedit&&0==s.cellendedit(t,i,s.columntype,this.editcell.value,n)?(this._raiseEvent(18,{rowindex:t,row:x,datafield:i,displayfield:s.displayfield,oldvalue:oldvalue,value:oldvalue,columntype:s.columntype}),c(this),!1):(this._raiseEvent(18,{rowindex:t,row:x,datafield:i,displayfield:s.displayfield,oldvalue:oldvalue,value:n,columntype:s.columntype}),this._hidecelleditor(!1),void 0!=this.editcell&&(this.editcell.editor=null,this.editcell.editing=!1),this.editcell=null,this.editchar=null,this.setcellvalue(t,i,n,o),this.enablebrowserselection||(this.host.addClass("jqx-disableselect"),this.content.addClass("jqx-disableselect")),e.jqx.browser.msie||r(),e.data(document.body,"jqxgrid.edit",""),!0)}this.endrowedit(t,l)}},beginrowedit:function(t){var i=this;i._oldselectedrow=t,this._cellscache=new Array;var l=!1;if("selectedrow"!=this.editmode&&(l=!0),l){var o=this.editmode;this.editmode="selectedrow"}var d=null;e.each(this.columns.records,function(e,l){if(i.editable&&this.editable){if("checkbox"===this.columntype||"custom"===this.columntype||"widget"===this.columntype||"template"===this.columntype||"button"===this.columntype)return!0;d||(d=this.datafield);var o=i.getcell(t,this.datafield);i.begincelledit(t,this.datafield,null,!1,!1);var s=i.getrowdata(t);i._raiseEvent(17,{rowindex:t,row:s,datafield:this.datafield,value:o.value,columntype:this.columntype})}}),i.editcell&&(i.editcell.init=!0),this._renderrows(this.virtualsizeinfo),l&&(this.editmode=o),d&&i.editcell&&setTimeout(function(){if(i.editcell&&i.editcell[d]){var e=i.editcell[d].editor;e&&(e.data().jqxWidget&&e.data().jqxWidget.focus?e.data().jqxWidget.focus():e.focus())}},25)},endrowedit:function(t,i){q=this;if(this._currentEditableColumn=0,this._focusedColumn=null,this._currentColumn=null,this._checkboxCells=[],!this.editcell)return!1;if(void 0==this.editcell.editor&&"checkbox"!==this.editcell.columntype)return!1;var l=!1;if("selectedrow"!=this.editmode&&(l=!0),l){var o=this.editmode;this.editmode="selectedrow"}var d=!1,s={};this.validationpopup&&(this.validationpopup.hide(),this.validationpopuparrow.hide());for(w=0;w<this.columns.records.length;w++)if((b=this.columns.records[w]).editable&&!b.hidden&&"checkbox"!=b.columntype&&!b.createwidget){var a=this._geteditorvalue(b),r=function(e){e._hidecelleditor();var i=e.getcellvalue(e.editcell.row,b.displayfield);if(b.cellendedit&&b.cellendedit(t,g,b.columntype,i,a),e.editchar=null,b.displayfield!=b.datafield){var l=e.getcellvalue(e.editcell.row,b.displayfield);n={value:i,label:l}}else n=i;var o=e.getrowdata(t);e._raiseEvent(18,{rowindex:t,row:o,datafield:g,displayfield:b.displayfield,oldvalue:i,value:i,columntype:b.columntype}),e.editcell.editing=!1};if(i)r(this);else{if(b.cellvaluechanging){var n=this.getcellvalue(this.editcell.row,b.displayfield),c=b.cellvaluechanging(t,g,b.columntype,n,a);void 0!=c&&(a=c)}g=b.datafield;if(b.validation){var h=this.getcell(t,b.datafield);try{var u=b.validation(h,a),p=this.gridlocalization.validationstring;if(void 0!=u.message&&(p=u.message),!(j="boolean"==typeof u?u:u.result)){void 0!=u.showmessage&&1!=u.showmessage||this._showvalidationpopup(t,g,p),d=!0,this.editcell[b.datafield].validated=!1;continue}}catch(e){this._showvalidationpopup(t,g,this.gridlocalization.validationstring),this.editcell[b.datafield].validated=!1,d=!0;continue}}if(b.displayfield!=b.datafield){var f=this.getcellvalue(this.editcell.row,b.displayfield),v=this.editcell.value;n={value:v,label:f}}else n=this.getcellvalue(this.editcell.row,b.displayfield);s[b.datafield]={newvalue:a,oldvalue:n}}}var m={},x={};if(!d){this._hidecelleditor(!1);for(var w=0;w<this.columns.records.length;w++){var b=this.columns.records[w],g=b.datafield;if(!b.hidden&&b.editable){_=this.getrowdata(t);if(!b.createwidget)if("checkbox"!=b.columntype){if(s[b.datafield]){var a=s[b.datafield].newvalue,n=s[b.datafield].oldvalue;b.cellendedit&&0==b.cellendedit(t,g,b.columntype,n,a)?(this._raiseEvent(18,{rowindex:t,row:_,datafield:g,displayfield:b.displayfield,oldvalue:n,value:n,columntype:b.columntype}),r(this)):(this.source.updaterow||this._raiseEvent(18,{rowindex:t,row:_,datafield:b.datafield,displayfield:b.displayfield,oldvalue:n,value:a,columntype:b.columntype}),m[b.datafield]=a,x[b.datafield]=n)}}else{a=this.getcellvalue(t,b.displayfield);this._raiseEvent(18,{rowindex:t,row:_,datafield:b.datafield,displayfield:b.displayfield,oldvalue:a,value:a,columntype:b.columntype})}}}var y=this.getrowid(t),_=this.getrowdata(t);if(e.each(m,function(e,t){if(t&&void 0!=t.label){var i=q.getcolumn(e);_[i.displayfield]=t.label,_[i.datafield]=t.value}else _[e]=t}),this.enablebrowserselection||(this.host.addClass("jqx-disableselect"),this.content.addClass("jqx-disableselect")),e.data(document.body,"jqxgrid.edit",""),this.editcell=null,this.editchar=null,this.source.updaterow&&!i){var q=this,j=function(i){var l=q.source.updaterow;q.source.updaterow=null,0==i?(e.each(x,function(e,t){if(t&&void 0!=t.label){var i=q.getcolumn(e);_[i.displayfield]=t.label,_[i.datafield]=t.value}else _[e]=t}),q.updaterow(y,_)):q.updaterow(y,_);for(var o=0;o<q.columns.records.length;o++){var d=q.columns.records[o];d.datafield;q._raiseEvent(18,{rowindex:t,datafield:d.datafield,row:_,displayfield:d.displayfield,oldvalue:x[d.datafield],value:_[d.displayfield],columntype:d.columntype})}q.source.updaterow=l};try{void 0==this.source.updaterow(y,_,j)&&!0}catch(e){return void!1}}else i||this.updaterow(y,_),this._renderrows(this.virtualsizeinfo)}return l&&(this.editmode=o),d},_selection:function(e){if("selectionStart"in e[0]){var t=e[0],i=t.selectionEnd-t.selectionStart;return{start:t.selectionStart,end:t.selectionEnd,length:i,text:t.value}}var l=document.selection.createRange();if(null==l)return{start:0,end:t.value.length,length:0};var o=e[0].createTextRange(),d=o.duplicate();o.moveToBookmark(l.getBookmark()),d.setEndPoint("EndToStart",o);i=l.text.length;return{start:d.text.length,end:d.text.length+l.text.length,length:i,text:l.text}},_setSelection:function(e,t,i){if("selectionStart"in i[0])i[0].focus(),i[0].setSelectionRange(e,t);else{var l=i[0].createTextRange();l.collapse(!0),l.moveEnd("character",t),l.moveStart("character",e),l.select()}},findRecordIndex:function(e,t,i){var i=i;if(t)for(var l=i.length,o=0;o<l;o++)if(e==i[o].label)return o;return-1},_destroyeditors:function(){var t=this;this.columns.records&&(e.each(this.columns.records,function(i,l){var o=e.trim(this.datafield).split(" ").join("");switch(this.columntype){case"dropdownlist":var d=t.editors["dropdownlist_"+o];d&&(d.jqxDropDownList("destroy"),t.editors["dropdownlist_"+o]=null);break;case"combobox":var s=t.editors["combobox_"+o];s&&(s.jqxComboBox("destroy"),t.editors["combobox_"+o]=null);break;case"datetimeinput":var a=t.editors["datetimeinput_"+this.datafield];a&&(a.jqxDateTimeInput("destroy"),t.editors["datetimeinput_"+o]=null);break;case"numberinput":var r=t.editors["numberinput_"+o];r&&(r.jqxNumberInput("destroy"),t.editors["numberinput_"+o]=null);break;case"custom":case"template":if(t.destroyeditor&&t.editors["templateeditor_"+o]&&(t.destroyeditor(t.editors["templateeditor_"+o]),t.editors["templateeditor_"+o]=null),t.destroyeditor)for(var n=t.getrows.length(),c=0;c<n;c++)t.editors["customeditor_"+o+"_"+c]&&(t.destroyeditor(t.editors["customeditor_"+o+"_"+c],c),t.editors["customeditor_"+o+"_"+c]=null);break;case"textbox":default:var h=t.editors["textboxeditor_"+o];h&&(t.removeHandler(h,"keydown"),t.editors["textbox_"+o]=null)}}),t.editors=new Array)},_showcelleditor:function(t,i,l,o,d){if(void 0!=l&&null!=this.editcell)if("checkbox"==i.columntype&&i.editable)"selectedrow"==this.editmode&&(this._checkboxCells||(this._checkboxCells=[]),this._checkboxCells[i.datafield]=l);else{void 0==d&&(d=!0),"selectedrow"==this.editmode&&(this.editchar="",d=!1);var s=i.datafield,a=e(l),r=this,n=this.editcell.editor,c=this.getcellvalue(t,s),h=this.getcelltext(t,s),u=this.hScrollInstance.value,p=parseInt(u);this.columns.records.indexOf(i);if(this.editcell.element=l,0==this.editcell.validated){var f="";this.validationpopup&&(f=this.validationpopup.text()),this._showvalidationpopup(t,s,f)}var v=function(e){r.hScrollInstance.isScrolling()||r.vScrollInstance.isScrolling()||d&&(r.isTouchDevice()||(e&&e.focus(),0!=r.gridcontent[0].scrollTop&&(r.scrolltop(Math.abs(r.gridcontent[0].scrollTop)),r.gridcontent[0].scrollTop=0),0!=r.gridcontent[0].scrollLeft&&(r.gridcontent[0].scrollLeft=0)))};switch(i.columntype){case"dropdownlist":if(this.host.jqxDropDownList){l.innerHTML="";var m=e.trim(i.datafield).split(" ").join(""),x=e.trim(i.displayfield).split(" ").join("");-1!=m.indexOf(".")&&(m=m.replace(".","")),-1!=x.indexOf(".")&&(x=x.replace(".",""));var w=this.editors["dropdownlist_"+m];if((n=void 0==w?e("<div style='border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 799; top: 0px; left: 0px; position: absolute;' id='dropdownlisteditor'></div>"):w).css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-p+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",p+parseInt(e(l).position().left)),void 0==w){n.prependTo(this.table),n[0].id="dropdownlisteditor"+this.element.id+m;_=null;if(y=!!this.source._source){q={localdata:this.source.records,datatype:this.source.datatype,async:!1};_=new e.jqx.dataAdapter(q,{autoBind:!1,async:!1,uniqueDataFields:[x],autoSort:!0,autoSortField:x})}else _=new e.jqx.dataAdapter(this.source,{autoBind:!1,uniqueDataFields:[x],async:!1,autoSort:!0,autoSortField:x});j=!i.createeditor;n.jqxDropDownList({enableBrowserBoundsDetection:!0,keyboardSelection:!1,source:_,rtl:this.rtl,autoDropDownHeight:j,theme:this.theme,width:a.width()-2,height:a.height()-2,displayMember:x,valueMember:s}),this.editors["dropdownlist_"+m]=n,i.createeditor&&i.createeditor(t,c,n)}i._requirewidthupdate&&n.jqxDropDownList({width:a.width()-2});I=n.jqxDropDownList("listBox").visibleItems;i.createeditor||(I.length<8?n.jqxDropDownList("autoDropDownHeight",!0):n.jqxDropDownList("autoDropDownHeight",!1));var c=this.getcellvalue(t,x),b=this.findRecordIndex(c,x,I);if(o&&(""!=c?n.jqxDropDownList("selectIndex",b,!0):n.jqxDropDownList("selectIndex",-1)),!this.editcell)return;void 0!=this.editcell.defaultvalue&&n.jqxDropDownList("selectIndex",this.editcell.defaultvalue,!0),d&&n.jqxDropDownList("focus")}break;case"combobox":if(this.host.jqxComboBox){l.innerHTML="";var m=e.trim(i.datafield).split(" ").join(""),x=e.trim(i.displayfield).split(" ").join("");-1!=m.indexOf(".")&&(m=m.replace(".","")),-1!=x.indexOf(".")&&(x=x.replace(".",""));var g=this.editors["combobox_"+m];if((n=void 0==g?e("<div style='border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 799; top: 0px; left: 0px; position: absolute;' id='comboboxeditor'></div>"):g).css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-p+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",p+parseInt(e(l).position().left)),void 0==g){n.prependTo(this.table),n[0].id="comboboxeditor"+this.element.id+m;var y=!!this.source._source,_=null;if(y){var q={localdata:this.source.records,datatype:this.source.datatype,async:!1};_=new e.jqx.dataAdapter(q,{autoBind:!1,async:!1,uniqueDataFields:[x],autoSort:!0,autoSortField:x})}else _=new e.jqx.dataAdapter(this.source,{autoBind:!1,uniqueDataFields:[x],async:!1,autoSort:!0,autoSortField:x});var j=!i.createeditor;n.jqxComboBox({enableBrowserBoundsDetection:!0,keyboardSelection:!1,source:_,rtl:this.rtl,autoDropDownHeight:j,theme:this.theme,width:a.width()-2,height:a.height()-2,displayMember:x,valueMember:s}),n.removeAttr("tabindex"),n.find("div").removeAttr("tabindex"),this.editors["combobox_"+m]=n,i.createeditor&&i.createeditor(t,c,n)}i._requirewidthupdate&&n.jqxComboBox({width:a.width()-2});var I=n.jqxComboBox("listBox").visibleItems;i.createeditor||(I.length<8?n.jqxComboBox("autoDropDownHeight",!0):n.jqxComboBox("autoDropDownHeight",!1));var c=this.getcellvalue(t,x),b=this.findRecordIndex(c,x,I);if(o&&(""!=c?(n.jqxComboBox("selectIndex",b,!0),n.jqxComboBox("val",c)):(n.jqxComboBox("selectIndex",-1),n.jqxComboBox("val",c))),!this.editcell)return;void 0!=this.editcell.defaultvalue&&n.jqxComboBox("selectIndex",this.editcell.defaultvalue,!0),this.editchar&&this.editchar.length>0&&n.jqxComboBox("input").val(this.editchar),d&&setTimeout(function(){if(v(n.jqxComboBox("input")),n)if(n.jqxComboBox("_setSelection",0,0),r.editchar)n.jqxComboBox("_setSelection",1,1),r.editchar=null;else if(n.jqxComboBox("input")){var e=n.jqxComboBox("input").val();n.jqxComboBox("_setSelection",0,e.length)}},10)}break;case"datetimeinput":if(this.host.jqxDateTimeInput){l.innerHTML="",-1!=(m=e.trim(i.datafield).split(" ").join("")).indexOf(".")&&(m=m.replace(".",""));var D=this.editors["datetimeinput_"+m];if((n=void 0==D?e("<div style='border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 799; top: 0px; left: 0px; position: absolute;' id='datetimeeditor'></div>"):D).show(),n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-p+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",p+parseInt(e(l).position().left)),void 0==D){n.prependTo(this.table),n[0].id="datetimeeditor"+this.element.id+m;var C={calendar:this.gridlocalization};n.jqxDateTimeInput({firstDayOfWeek:this.gridlocalization.firstDay,enableBrowserBoundsDetection:!0,localization:C,_editor:!0,theme:this.theme,rtl:this.rtl,width:a.width(),height:a.height(),formatString:i.cellsformat}),this.editors["datetimeinput_"+m]=n,i.createeditor&&i.createeditor(t,c,n)}if(i._requirewidthupdate&&n.jqxDateTimeInput({width:a.width()-2}),o){if(""!=c&&null!=c){var k=new Date(c);"Invalid Date"==k&&this.source.getvaluebytype&&(k=this.source.getvaluebytype(c,{name:i.datafield,type:"date"})),n.jqxDateTimeInput("setDate",k)}else n.jqxDateTimeInput("setDate",null);void 0!=this.editcell.defaultvalue&&n.jqxDateTimeInput("setDate",this.editcell.defaultvalue)}if(d){var T=this.editEvent;setTimeout(function(){v(n.jqxDateTimeInput("dateTimeInput")),setTimeout(function(){if(n.jqxDateTimeInput("_selectGroup",0),r.editchar&&r.editchar.length>0){var e=parseInt(r.editchar);if(!isNaN(e)&&T){var t=T.charCode?T.charCode:T.keyCode?T.keyCode:0;n.jqxDateTimeInput("_handleKeyPress",T,t)}}},25)},10)}}break;case"numberinput":if(this.host.jqxNumberInput){l.innerHTML="",-1!=(m=e.trim(i.datafield).split(" ").join("")).indexOf(".")&&(m=m.replace(".",""));var S=this.editors["numberinput_"+m];if((n=void 0==S?e("<div style='border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 799; top: 0px; left: 0px; position: absolute;' id='numbereditor'></div>"):S).show(),n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-p+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",p+parseInt(e(l).position().left)),void 0==S){n.prependTo(this.table),n[0].id="numbereditor"+this.element.id+m;var B="",z="left",O=2;i.cellsformat?-1!=i.cellsformat.indexOf("c")?(B=this.gridlocalization.currencysymbol,z="before"==(z=this.gridlocalization.currencysymbolposition)?"left":"right",i.cellsformat.length>1&&(O=parseInt(i.cellsformat.substring(1),10))):-1!=i.cellsformat.indexOf("p")&&(B=this.gridlocalization.percentsymbol,z="right",i.cellsformat.length>1&&(O=parseInt(i.cellsformat.substring(1),10))):O=0,n.jqxNumberInput({decimalSeparator:this.gridlocalization.decimalseparator,decimalDigits:O,inputMode:"simple",theme:this.theme,rtl:this.rtl,width:a.width()-1,height:a.height()-1,spinButtons:!0,symbol:B,symbolPosition:z}),this.editors["numberinput_"+m]=n,i.createeditor&&i.createeditor(t,c,n)}if(i._requirewidthupdate&&n.jqxNumberInput({width:a.width()-2}),o){if(""!=c&&null!=c){var N=c;n.jqxNumberInput("setDecimal",N)}else n.jqxNumberInput("setDecimal",0);if(void 0!=this.editcell.defaultvalue&&n.jqxNumberInput("setDecimal",this.editcell.defaultvalue),this.editchar&&this.editchar.length>0){var L=parseInt(this.editchar);isNaN(L)||n.jqxNumberInput("setDecimal",L)}d&&setTimeout(function(){if(v(n.jqxNumberInput("numberInput")),n.jqxNumberInput("_setSelectionStart",0),r.editchar)i.cellsformat.length>0?n.jqxNumberInput("_setSelectionStart",2):n.jqxNumberInput("_setSelectionStart",1),r.editchar=null;else{if(n.jqxNumberInput("spinButtons")){e=n.jqxNumberInput("numberInput").val();r._setSelection(n.jqxNumberInput("numberInput")[0],e.length,e.length)}else{var e=n.jqxNumberInput("numberInput").val();r._setSelection(n.jqxNumberInput("numberInput")[0],0,e.length)}n.jqxNumberInput("selectAll")}},10)}}break;case"custom":l.innerHTML="",-1!=(m=e.trim(i.datafield).split(" ").join("")).indexOf(".")&&(m=m.replace(".",""));var E=this.editors["customeditor_"+m+"_"+t];if((n=void 0==E?e("<div style='overflow: hidden; border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 799; top: 0px; left: 0px; position: absolute;' id='customeditor'></div>"):E).show(),n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-p+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",p+parseInt(e(l).position().left)),void 0==E){n.prependTo(this.table),n[0].id="customeditor"+this.element.id+m+"_"+t,this.editors["customeditor_"+m+"_"+t]=n;var H=a.width()-1,P=a.height()-1;n.width(H),n.height(P),i.createeditor&&i.createeditor(t,c,n,h,H,P,this.editchar)}i._requirewidthupdate&&n.width(a.width()-2);break;case"template":l.innerHTML="",-1!=(m=e.trim(i.datafield).split(" ").join("")).indexOf(".")&&(m=m.replace(".",""));var M=this.editors["templateeditor_"+m];if((n=void 0==M?e("<div style='overflow: hidden; border-radius: 0px; -moz-border-radius: 0px; -webkit-border-radius: 0px; z-index: 799; top: 0px; left: 0px; position: absolute;' id='templateeditor'></div>"):M).show(),n.css("top",e(l).parent().position().top),this.oldhscroll?n.css("left",-p+parseInt(e(l).position().left)):n.css("left",parseInt(e(l).position().left)),i.pinned&&n.css("left",p+parseInt(e(l).position().left)),void 0==M){n.prependTo(this.table),n[0].id="templateeditor"+this.element.id+m,this.editors["templateeditor_"+m]=n;var H=a.width()-1,P=a.height()-1;n.width(H),n.height(P),i.createeditor&&i.createeditor(t,c,n,h,H,P,this.editchar)}i._requirewidthupdate&&n.width(a.width()-2);break;case"textbox":default:l.innerHTML="",(n=this.editors["textboxeditor_"+i.datafield]||e("<input autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' type='textbox' id='textboxeditor'/>"))[0].id="textboxeditor"+this.element.id+i.datafield,n.appendTo(a),this.rtl&&n.css("direction","rtl"),(o||""==n[0].className)&&(n.addClass(this.toThemeProperty("jqx-input")),n.addClass(this.toThemeProperty("jqx-widget-content")),this.editchar&&this.editchar.length>0?n.val(this.editchar):(""!=i.cellsformat&&(c=this.getcelltext(t,s)),void 0==c&&(c=""),n.val(c)),void 0!=this.editcell.defaultvalue&&n.val(this.editcell.defaultvalue),n.width(a.width()+1),n.height(a.height()+1),i.createeditor&&i.createeditor(t,c,n),""!=i.cellsformat&&(-1==i.cellsformat.indexOf("p")&&-1==i.cellsformat.indexOf("c")&&-1==i.cellsformat.indexOf("n")&&-1==i.cellsformat.indexOf("f")||this.editors["textboxeditor_"+i.datafield]||n.keydown(function(e){var t=e.charCode?e.charCode:e.keyCode?e.keyCode:0,l=String.fromCharCode(t),o=parseInt(l);if(isNaN(o))return!0;if(r._selection(n).length>0)return!0;var d="",s=n.val();if(i.cellsformat.length>1){a=parseInt(i.cellsformat.substring(1));isNaN(a)&&(a=0)}else var a=0;if(a>0&&-1!=s.indexOf(r.gridlocalization.decimalseparator)&&r._selection(n).start>s.indexOf(r.gridlocalization.decimalseparator))return!0;for(var c=0;c<s.length-a;c++){var h=s.substring(c,c+1);null!=h.match(/^[0-9]+$/)&&(d+=h)}return!(d.length>=11)&&void 0}))),this.editors["textboxeditor_"+i.datafield]=n,o&&d&&setTimeout(function(){v(n),r.editchar?(r._setSelection(n[0],1,1),r.editchar=null):r._setSelection(n[0],0,n.val().length)},25)}n&&(n[0].style.zIndex=1+parseInt(l.style.zIndex),e.jqx.browser.msie&&e.jqx.browser.version<8&&(n[0].style.zIndex=1+this.columns.records.length+l.style.zIndex),n.css("display","block"),this.editcell.editor=n,this.editcell[s]?this.editcell[s].editor=n:(this.editcell[s]={},this.editcell[s].editor=n)),o&&i.initeditor&&i.initeditor(t,c,n,h,this.editchar),r.isTouchDevice()||setTimeout(function(){r.content&&(r.content[0].scrollTop=0,r.content[0].scrollLeft=0),r.gridcontent&&(r.gridcontent[0].scrollLeft=0,r.gridcontent[0].scrollTop=0)},10)}},_setSelection:function(e,t,i){try{if("selectionStart"in e)e.setSelectionRange(t,i);else{var l=e.createTextRange();l.collapse(!0),l.moveEnd("character",i),l.moveStart("character",t),l.select()}}catch(e){}},_hideeditors:function(){if(null!=this.editcells){var e=this;for(var t in this.editcells)e.editcell=e.editcells[t],e._hidecelleditor()}},_hidecelleditor:function(e){if(this.editcell)if("selectedrow"!==this.editmode){if("checkbox"!=this.editcell.columntype){if(this.editcell.editor)switch(this.editcell.editor.hide(),this.editcell.columntype){case"dropdownlist":this.editcell.editor.jqxDropDownList({closeDelay:0}),this.editcell.editor.jqxDropDownList("hideListBox"),this.editcell.editor.jqxDropDownList({closeDelay:300});break;case"combobox":this.editcell.editor.jqxComboBox({closeDelay:0}),this.editcell.editor.jqxComboBox("hideListBox"),this.editcell.editor.jqxComboBox({closeDelay:300});break;case"datetimeinput":var t=this.editcell.editor;t.jqxDateTimeInput("isOpened")&&(t.jqxDateTimeInput({closeDelay:0}),t.jqxDateTimeInput("hideCalendar"),t.jqxDateTimeInput({closeDelay:300}))}this.validationpopup&&(this.validationpopup.hide(),this.validationpopuparrow.hide()),this.isNestedGrid||0!=e&&this.element.focus()}}else{for(var i=0;i<this.columns.records.length;i++){var l=this.columns.records[i];if(this.editcell[l.datafield]&&this.editcell[l.datafield].editor){this.editcell[l.datafield].editor.hide();var o=this.editcell[l.datafield].editor;switch(l.columntype){case"dropdownlist":o.jqxDropDownList({closeDelay:0}),o.jqxDropDownList("hideListBox"),o.jqxDropDownList({closeDelay:300});break;case"combobox":o.jqxComboBox({closeDelay:0}),o.jqxComboBox("hideListBox"),o.jqxComboBox({closeDelay:300});break;case"datetimeinput":o.jqxDateTimeInput("isOpened")&&(o.jqxDateTimeInput({closeDelay:0}),o.jqxDateTimeInput("hideCalendar"),o.jqxDateTimeInput({closeDelay:300}))}}}this.validationpopup&&(this.validationpopup.hide(),this.validationpopuparrow.hide())}},_geteditorvalue:function(t){var i=new String;if(!this.editcell)return null;l=this.editcell.editor;if("selectedrow"==this.editmode&&this.editcell[t.datafield])var l=this.editcell[t.datafield].editor;if(l){switch(t.columntype){case"textbox":default:if(i=l.val(),""!=t.cellsformat){var o="string",d=this.source.datafields||(this.source._source?this.source._source.datafields:null);if(d){var s="";e.each(d,function(){if(this.name==t.displayfield)return this.type&&(s=this.type),!1}),s&&(o=s)}var a="number"===o||"float"===o||"int"===o||"integer"===o,r="date"===o||"time"===o;if(a||"string"===o&&(-1!=t.cellsformat.indexOf("p")||-1!=t.cellsformat.indexOf("c")||-1!=t.cellsformat.indexOf("n")||-1!=t.cellsformat.indexOf("f"))){if(""===i&&t.nullable)return"";i.indexOf(this.gridlocalization.currencysymbol)>-1&&(i=i.replace(this.gridlocalization.currencysymbol,""));var n=i;if(n=new Number(n),!isNaN(n))return n;(i=(i=function(e,t,i){var l=e;if(t==i)return e;for(var o=l.indexOf(t);-1!=o;)o=(l=l.replace(t,i)).indexOf(t);return l}(i,this.gridlocalization.thousandsseparator,"")).replace(this.gridlocalization.decimalseparator,".")).indexOf(this.gridlocalization.percentsymbol)>-1&&(i=i.replace(this.gridlocalization.percentsymbol,""));for(var c="",h=0;h<i.length;h++){var u=i.substring(h,h+1);"-"===u&&(c+="-"),"."===u&&(c+="."),null!=u.match(/^[0-9]+$/)&&(c+=u)}i=(i=c).replace(/ /g,""),i=new Number(i),isNaN(i)&&(i="")}if(r||"string"===o&&(-1!=t.cellsformat.indexOf("H")||-1!=t.cellsformat.indexOf("m")||-1!=t.cellsformat.indexOf("M")||-1!=t.cellsformat.indexOf("y")||-1!=t.cellsformat.indexOf("h")||-1!=t.cellsformat.indexOf("d"))){if(""===i&&t.nullable)return"";var p=i;e.jqx.dataFormat&&(i=e.jqx.dataFormat.tryparsedate(p,this.gridlocalization)),"Invalid Date"!=i&&null!=i||(i="")}}t.displayfield!=t.datafield&&(i={label:i,value:i});break;case"checkbox":l.jqxCheckBox&&(i=l.jqxCheckBox("checked"));break;case"datetimeinput":if(l.jqxDateTimeInput){if(l.jqxDateTimeInput({isEditing:!1}),"none"!==l.jqxDateTimeInput("container").css("display")&&l.jqxDateTimeInput("close"),l.jqxDateTimeInput("_validateValue"),null==(i=l.jqxDateTimeInput("getDate")))return null;i=new Date(i.toString()),t.displayfield!=t.datafield&&(i={label:i,value:i})}break;case"dropdownlist":if(l.jqxDropDownList){var f=l.jqxDropDownList("selectedIndex"),v=l.jqxDropDownList("listBox").getVisibleItem(f);null==(i=t.displayfield!=t.datafield?v?{label:v.label,value:v.value}:"":v?v.label:"")&&(i="")}break;case"combobox":l.jqxComboBox&&(i=l.jqxComboBox("val"),t.displayfield!=t.datafield&&null!=(v=l.jqxComboBox("getSelectedItem"))&&(i={label:v.label,value:v.value}),null==i&&(i=""));break;case"numberinput":if(l.jqxNumberInput){this.touchdevice&&l.jqxNumberInput("_doTouchHandling");var m=l.jqxNumberInput("getDecimal");i=new Number(m),i=parseFloat(i),isNaN(i)&&(i=0),null===m&&(i=null),t.displayfield!=t.datafield&&(i={label:i,value:i})}}t.geteditorvalue&&(i="selectedrow"==this.editmode?t.geteditorvalue(this.editcell.row,this.getcellvalue(this.editcell.row,t.datafield),l):t.geteditorvalue(this.editcell.row,this.editcell.value,l))}return i},hidevalidationpopups:function(){this.popups&&(e.each(this.popups,function(){this.validation.remove(),this.validationrow.remove()}),this.popups=new Array),this.validationpopup&&(this.validationpopuparrow.hide(),this.validationpopup.hide())},showvalidationpopup:function(t,i,l){if(void 0==l)var l=this.gridlocalization.validationstring;var o=e("<div style='z-index: 99999; top: 0px; left: 0px; position: absolute;'></div>"),d=e("<div style='width: 20px; height: 20px; z-index: 999999; top: 0px; left: 0px; position: absolute;'></div>");o.html(l),d.addClass(this.toThemeProperty("jqx-grid-validation-arrow-up")),o.addClass(this.toThemeProperty("jqx-grid-validation")),o.addClass(this.toThemeProperty("jqx-rc-all")),o.prependTo(this.table),d.prependTo(this.table);for(var s=this.hScrollInstance.value,a=parseInt(s),r=this.getcolumn(i).uielement,n=null,c=0;c<this.hittestinfo.length;c++)t===this.hittestinfo[c].row.visibleindex&&(n=this.hittestinfo[c]);if(!n){this.ensurerowvisible(t);var h=this;return o.remove(),d.remove(),void setTimeout(function(){for(var e=null,o=0;o<h.hittestinfo.length;o++)t===h.hittestinfo[o].row.visibleindex&&(e=h.hittestinfo[o]);e&&h.showvalidationpopup(t,i,l)},25)}var u=e(n.visualrow);o.css("top",parseInt(u.position().top)+30+"px");var p=parseInt(o.css("top"));d.css("top",p-12),d.removeClass(),d.addClass(this.toThemeProperty("jqx-grid-validation-arrow-up"));var f=!1;p>=this._gettableheight()&&(d.removeClass(this.toThemeProperty("jqx-grid-validation-arrow-up")),d.addClass(this.toThemeProperty("jqx-grid-validation-arrow-down")),(p=parseInt(u.position().top)-this.rowsheight-5)<0&&(p=0,this.validationpopuparrow.removeClass(this.toThemeProperty("jqx-grid-validation-arrow-down")),f=!0),o.css("top",p+"px"),d.css("top",p+o.outerHeight()-9));var v=-a+parseInt(e(r).position().left);d.css("left",a+v+30);var m=o.width();m+v>this.host.width()-20&&(v-=m+v-this.host.width()+40),f?o.css("left",a+parseInt(e(r).position().left)-o.outerWidth()):o.css("left",a+v),o.show(),d.show(),this.popups||(this.popups=new Array),this.popups[this.popups.length]={validation:o,validationrow:d}},_showvalidationpopup:function(t,i,l){var o=this.editcell,d=this.editcell.editor;if("selectedrow"==this.editmode&&(o=this.editcell[i])&&o.editor&&(d=o.editor,o.element=d),d&&!(this.validationpopup&&e.jqx.isHidden(this.validationpopup)&&(this.validationpopup.remove&&(this.validationpopup.remove(),this.validationpopuparrow.remove()),this.validationpopup=null,this.validationpopuparrow=null,void 0===i&&void 0===l&&this.editors&&0===this.editors.length))){if(this.validationpopup)this.validationpopup.html(l);else{var s=e("<div style='z-index: 99999; top: 0px; left: 0px; position: absolute;'></div>"),a=e("<div style='width: 20px; height: 20px; z-index: 999999; top: 0px; left: 0px; position: absolute;'></div>");s.html(l),a.addClass(this.toThemeProperty("jqx-grid-validation-arrow-up")),s.addClass(this.toThemeProperty("jqx-grid-validation")),s.addClass(this.toThemeProperty("jqx-rc-all")),s.prependTo(this.table),a.prependTo(this.table),this.validationpopup=s,this.validationpopuparrow=a}var r=this.hScrollInstance.value,n=parseInt(r);"selectedrow"==this.editmode?this.visiblerows&&this.visiblerows[this.editcell.visiblerowindex]?this.validationpopup.css("top",this.visiblerows[this.editcell.visiblerowindex].top+(this.rowsheight+5)+"px"):this.validationpopup.css("top",parseInt(e(o.editor).position().top)+(this.rowsheight+5)+"px"):this.validationpopup.css("top",parseInt(e(o.element).parent().position().top)+(this.rowsheight+5)+"px");var c=parseInt(this.validationpopup.css("top"));this.validationpopuparrow.css("top",c-11),this.validationpopuparrow.removeClass(),this.validationpopuparrow.addClass(this.toThemeProperty("jqx-grid-validation-arrow-up"));var h=!1;c>=this._gettableheight()&&(this.validationpopuparrow.removeClass(this.toThemeProperty("jqx-grid-validation-arrow-up")),this.validationpopuparrow.addClass(this.toThemeProperty("jqx-grid-validation-arrow-down")),c=parseInt(e(o.element).parent().position().top)-this.rowsheight-5,"selectedrow"==this.editmode&&(c=this.visiblerows&&this.visiblerows[this.editcell.visiblerowindex]?this.visiblerows[this.editcell.visiblerowindex].top-this.rowsheight-5:parseInt(e(o.editor).position().top)-this.rowsheight-5),c<0&&(c=0,this.validationpopuparrow.removeClass(this.toThemeProperty("jqx-grid-validation-arrow-down")),h=!0),this.validationpopup.css("top",c+"px"),this.validationpopuparrow.css("top",c+this.validationpopup.outerHeight()-9));var u=-n+parseInt(e(o.element).position().left);this.validationpopuparrow.css("left",n+u+30);var p=this.validationpopup.width();p+u>this.host.width()-20&&(u-=p+u-this.host.width()+40),h?this.validationpopup.css("left",n+parseInt(e(o.element).position().left)-this.validationpopup.outerWidth()):this.validationpopup.css("left",n+u),"none"==this.editcell.editor.css("display")?(this.validationpopup.hide(),this.validationpopuparrow.hide()):(this.validationpopup.show(),this.validationpopuparrow.show())}}})}(jqxBaseFramework);

