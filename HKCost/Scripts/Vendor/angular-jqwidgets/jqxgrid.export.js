/*
jQWidgets v5.1.0 (2017-Aug)
Copyright (c) 2011-2017 jQWidgets.
License: http://jqwidgets.com/license/
*/
!function(e){e.extend(e.jqx._jqxGrid.prototype,{exportdata:function(t,r,s,i,l,o,a){if(!e.jqx.dataAdapter.ArrayExporter)throw"jqxGrid: Missing reference to jqxdata.export.js!";void 0==s&&(s=!0);var d=this;if(void 0==i&&0==(i=this.getrows()).length)throw"No data to export.";this.exporting=!0,this.pageable||(this.loadondemand=!0),this.altrows&&this._renderrows(this.virtualsizeinfo);var n=void 0!=l&&l,h={},c={},f=this.host.find(".jqx-grid-cell:first"),g=this.host.find(".jqx-grid-cell-alt:first");f.removeClass(this.toThemeProperty("jqx-grid-cell-selected")),f.removeClass(this.toThemeProperty("jqx-fill-state-pressed")),g.removeClass(this.toThemeProperty("jqx-grid-cell-selected")),g.removeClass(this.toThemeProperty("jqx-fill-state-pressed")),f.removeClass(this.toThemeProperty("jqx-grid-cell-hover")),f.removeClass(this.toThemeProperty("jqx-fill-state-hover")),g.removeClass(this.toThemeProperty("jqx-grid-cell-hover")),g.removeClass(this.toThemeProperty("jqx-fill-state-hover"));for(var u="cell",p=1,m="column",y=1,x=[],v=0;v<this.columns.records.length;v++){var b=this.columns.records[v];if(""!=b.cellclassname)if(b.customCellStyles=new Array,"string"==typeof b.cellclassname)for(w=0;w<i.length;w++)b.customCellStyles[w]=b.cellclassname;else for(var w=0;w<i.length;w++){var C=this.getrowboundindex(w),S=b.cellclassname(C,b.displayfield,i[w][b.displayfield],i[w]);S&&(b.customCellStyles[w]=S)}}var j=new Array,q=null,T=null,_=null;if(e.each(this.columns.records,function(r){var l=e(d.table[0].rows[0].cells[r]);if(d.table[0].rows.length>1){var o=e(d.table[0].rows[1].cells[r]);_||(_=o)}T||(T=l);var a=this,f=function(e){if(e.removeClass(d.toThemeProperty("jqx-grid-cell-selected")),e.removeClass(d.toThemeProperty("jqx-fill-state-pressed")),e.removeClass(d.toThemeProperty("jqx-grid-cell-hover")),e.removeClass(d.toThemeProperty("jqx-fill-state-hover")),a.customCellStyles)for(var t in a.customCellStyles)e.removeClass(a.customCellStyles[t])};if(f(l),o&&f(o),null==this.displayfield)return!0;d.showaggregates&&d.getcolumnaggregateddata&&x.push(d.getcolumnaggregateddata(this.displayfield,this.aggregates,!0,i));var g=d._getexportcolumntype(this);!this.exportable||this.hidden&&!n||(h[this.displayfield]={},h[this.displayfield].text=this.text,h[this.displayfield].width=parseInt(this.width),isNaN(h[this.displayfield].width)&&(h[this.displayfield].width=60),h[this.displayfield].formatString=this.cellsformat,h[this.displayfield].localization=d.gridlocalization,h[this.displayfield].type=g,h[this.displayfield].cellsAlign=this.cellsalign,h[this.displayfield].hidden=!s,h[this.displayfield].displayfield=this.displayfield,j.push(h[this.displayfield])),u="cell"+p;var v=e(this.element);if(void 0==this.element&&(v=e(this.uielement)),q){if(!a._rendered){v=q,l=T,o=_;var b=d.toTP("jqx-grid-cell")+" "+d.toTP("jqx-item");l[0].className=b,b+=d.toTP("jqx-grid-cell-alt"),o&&(o[0].className=b)}}else q=v;if(m="column"+y,"html"==t||"xls"==t||"pdf"==t){var w=function(e,r,s,i,l,o,a,d,f){c[e]={},void 0!=r&&(c[e]["font-size"]=r.css("font-size"),c[e]["font-weight"]=r.css("font-weight"),c[e]["font-style"]=r.css("font-style"),c[e]["background-color"]=o._getexportcolor(r.css("background-color")),c[e].color=o._getexportcolor(r.css("color")),c[e]["border-color"]=o._getexportcolor(r.css("border-top-color")),s?c[e]["text-align"]=l.align:(c[e]["text-align"]=l.cellsalign,c[e].formatString=l.cellsformat,c[e].dataType=g),"html"!=t&&"pdf"!=t||(c[e]["border-top-width"]=r.css("border-top-width"),c[e]["border-left-width"]=r.css("border-left-width"),c[e]["border-right-width"]=r.css("border-right-width"),c[e]["border-bottom-width"]=r.css("border-bottom-width"),c[e]["border-top-style"]=r.css("border-top-style"),c[e]["border-left-style"]=r.css("border-left-style"),c[e]["border-right-style"]=r.css("border-right-style"),c[e]["border-bottom-style"]=r.css("border-bottom-style"),s?(0==a&&(c[e]["border-left-width"]=r.css("border-right-width")),c[e]["border-top-width"]=r.css("border-right-width"),c[e]["border-bottom-width"]=r.css("border-bottom-width")):0==a&&(c[e]["border-left-width"]=r.css("border-right-width")),c[e].height=r.css("height")),!l.exportable||l.hidden&&!n||(1==d?(h[l.displayfield].customCellStyles||(h[l.displayfield].customCellStyles=new Array),h[l.displayfield].customCellStyles[f]=e):s?h[l.displayfield].style=e:i?h[l.displayfield].cellAltStyle=e:h[l.displayfield].cellStyle=e))};if(w(m,v,!0,!1,this,d,r),y++,w(u,l,!1,!1,this,d,r),d.altrows&&w(u="cellalt"+p,o,!1,!0,this,d,r),this.customCellStyles){for(var C in a.customCellStyles)l.removeClass(a.customCellStyles[C]);for(var C in a.customCellStyles)l.addClass(a.customCellStyles[C]),w(u+a.customCellStyles[C],l,!1,!1,this,d,r,!0,C),l.removeClass(a.customCellStyles[C])}p++}}),e.each(this.columns.records,function(e){h[this.displayfield]&&(h[this.displayfield].columnsDataFields=j)}),this.showaggregates){var F=[],P="xls"==t?"_AG":"",N=this.groupable?this.groups.length:0;this.rowdetails&&N++,"checkbox"===this.selectionmode&&N++,x.length>0&&(e.each(this.columns.records,function(e){if(this.aggregates)for(var t=0;t<this.aggregates.length;t++)if(F[t]||(F[t]={}),F[t]){var r=d._getaggregatename(this.aggregates[t]),s=d._getaggregatetype(this.aggregates[t]),i=x[e-N];i&&(F[t][this.displayfield]=P+r+": "+i[s])}}),e.each(this.columns.records,function(e){for(var t=0;t<F.length;t++)void 0==F[t][this.displayfield]&&(F[t][this.displayfield]=P)})),e.each(F,function(){i.push(this)})}var O=this,A=e.jqx.dataAdapter.ArrayExporter(i,h,c);if(void 0==r){this._renderrows(this.virtualsizeinfo);var I=A.exportTo(t);return this.showaggregates&&e.each(F,function(){i.pop(this)}),setTimeout(function(){O.exporting=!1},50),I}A.exportToFile(t,r,o,a),this.showaggregates&&e.each(F,function(){i.pop(this)}),this._renderrows(this.virtualsizeinfo),setTimeout(function(){O.exporting=!1},50)},_getexportcolor:function(e){var t=e;if("transparent"==e&&(t="#FFFFFF"),t&&t.toString()||(t="#FFFFFF"),-1!=t.toString().indexOf("rgb")){var r=t.split(",");if(-1!=t.toString().indexOf("rgba")){var s=parseInt(r[0].substring(5)),i=parseInt(r[1]),l=parseInt(r[2]),o=parseInt(r[3].substring(1,4)),a={r:s,g:i,b:l},d=this._rgbToHex(a);return 0==s&&0==i&&0==l&&0==o?"#ffffff":"#"+d}a={r:s=parseInt(r[0].substring(4)),g:i=parseInt(r[1]),b:l=parseInt(r[2].substring(1,4))};return"#"+(d=this._rgbToHex(a))}return-1!=t.toString().indexOf("#")&&4==t.toString().length&&(t+=t.toString().substring(1,4)),t},_rgbToHex:function(e){return this._intToHex(e.r)+this._intToHex(e.g)+this._intToHex(e.b)},_intToHex:function(e){var t=parseInt(e).toString(16);return 1==t.length&&(t="0"+t),t.toUpperCase()},_getexportcolumntype:function(t){var r=this,s="string",i=r.source.datafields||(r.source._source?r.source._source.datafields:null);if(i){var l="";if(e.each(i,function(){if(this.name==t.displayfield)return this.type&&(l=this.type),!1}),l)return l}if(null!=t){if(void 0==this.dataview.cachedrecords)return s;var o=null;if(this.virtualmode)e.each(this.dataview.cachedrecords,function(){return o=this[t.displayfield],!1});else{if(0==this.dataview.cachedrecords.length)return s;if(null!=(o=this.dataview.cachedrecords[0][t.displayfield])&&""==o.toString())return"string"}if(null!=o){if(-1!=t.cellsformat.indexOf("c"))return"number";if(-1!=t.cellsformat.indexOf("n"))return"number";if(-1!=t.cellsformat.indexOf("p"))return"number";if(-1!=t.cellsformat.indexOf("d"))return"date";if(-1!=t.cellsformat.indexOf("y"))return"date";if(-1!=t.cellsformat.indexOf("M"))return"date";if(-1!=t.cellsformat.indexOf("m"))return"date";if(-1!=t.cellsformat.indexOf("t"))return"date";if("boolean"==typeof o)s="boolean";else if(e.jqx.dataFormat.isNumber(o))s="number";else{var a=new Date(o);if("NaN"==a.toString()||"Invalid Date"==a.toString())if(e.jqx.dataFormat){if(null!=(a=e.jqx.dataFormat.tryparsedate(o))){if(a&&a.getFullYear()&&1970==a.getFullYear()&&0==a.getMonth()&&1==a.getDate()){var d=new Number(o);return isNaN(d)?"string":"number"}return"date"}s="string"}else s="string";else s="date"}}}return s}})}(jqxBaseFramework);

